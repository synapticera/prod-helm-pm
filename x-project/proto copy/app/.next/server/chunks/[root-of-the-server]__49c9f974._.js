module.exports=[76909,(e,t,r)=>{"use strict";let a="u">typeof Buffer,s=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function i(e,t,r){null==r&&null!==t&&"object"==typeof t&&(r=t,t=void 0),a&&Buffer.isBuffer(e)&&(e=e.toString()),e&&65279===e.charCodeAt(0)&&(e=e.slice(1));let i=JSON.parse(e,t);if(null===i||"object"!=typeof i)return i;let l=r&&r.protoAction||"error",u=r&&r.constructorAction||"error";if("ignore"===l&&"ignore"===u)return i;if("ignore"!==l&&"ignore"!==u){if(!1===s.test(e)&&!1===n.test(e))return i}else if("ignore"!==l&&"ignore"===u){if(!1===s.test(e))return i}else if(!1===n.test(e))return i;return o(i,{protoAction:l,constructorAction:u,safe:r&&r.safe})}function o(e,{protoAction:t="error",constructorAction:r="error",safe:a}={}){let s=[e];for(;s.length;){let e=s;for(let n of(s=[],e)){if("ignore"!==t&&Object.prototype.hasOwnProperty.call(n,"__proto__")){if(!0===a)return null;if("error"===t)throw SyntaxError("Object contains forbidden prototype property");delete n.__proto__}if("ignore"!==r&&Object.prototype.hasOwnProperty.call(n,"constructor")&&Object.prototype.hasOwnProperty.call(n.constructor,"prototype")){if(!0===a)return null;if("error"===r)throw SyntaxError("Object contains forbidden prototype property");delete n.constructor}for(let e in n){let t=n[e];t&&"object"==typeof t&&s.push(t)}}}return e}function l(e,t,r){let a=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return i(e,t,r)}finally{Error.stackTraceLimit=a}}t.exports=l,t.exports.default=l,t.exports.parse=l,t.exports.safeParse=function(e,t){let r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return i(e,t,{safe:!0})}catch(e){return null}finally{Error.stackTraceLimit=r}},t.exports.scan=o},24868,(e,t,r)=>{t.exports=e.x("fs/promises",()=>require("fs/promises"))},67,e=>{"use strict";let t,r;var a,s,n,i,o,l,u,c,d,p,m,h,f,y,g,v,_,b,w,x,k,T,S,A,I,C=e.i(93274),E=e.i(78594),N=e.i(69956),R=e.i(33349),O=e.i(21171),j=e.i(92074),Z=e.i(44052),P=e.i(92037),M=e.i(299),$=e.i(74521),D=e.i(19591),U=e.i(72272),q=e.i(45179),F=e.i(42563),L=e.i(46487),z=e.i(93695);e.i(78606);var B=e.i(6757),V="vercel.ai.error",H=Symbol.for(V),J=class e extends Error{constructor({name:e,message:t,cause:r}){super(t),this[i]=!0,this.name=e,this.cause=r}static isInstance(t){return e.hasMarker(t,V)}static hasMarker(e,t){let r=Symbol.for(t);return null!=e&&"object"==typeof e&&r in e&&"boolean"==typeof e[r]&&!0===e[r]}toJSON(){return{name:this.name,message:this.message}}};i=H;var W=J,K="AI_APICallError",Y=`vercel.ai.error.${K}`,Q=Symbol.for(Y),G=class extends W{constructor({message:e,url:t,requestBodyValues:r,statusCode:a,responseHeaders:s,responseBody:n,cause:i,isRetryable:l=null!=a&&(408===a||409===a||429===a||a>=500),data:u}){super({name:K,message:e,cause:i}),this[o]=!0,this.url=t,this.requestBodyValues=r,this.statusCode=a,this.responseHeaders=s,this.responseBody=n,this.isRetryable=l,this.data=u}static isInstance(e){return W.hasMarker(e,Y)}static isAPICallError(e){return e instanceof Error&&e.name===K&&"string"==typeof e.url&&"object"==typeof e.requestBodyValues&&(null==e.statusCode||"number"==typeof e.statusCode)&&(null==e.responseHeaders||"object"==typeof e.responseHeaders)&&(null==e.responseBody||"string"==typeof e.responseBody)&&(null==e.cause||"object"==typeof e.cause)&&"boolean"==typeof e.isRetryable&&(null==e.data||"object"==typeof e.data)}toJSON(){return{name:this.name,message:this.message,url:this.url,requestBodyValues:this.requestBodyValues,statusCode:this.statusCode,responseHeaders:this.responseHeaders,responseBody:this.responseBody,cause:this.cause,isRetryable:this.isRetryable,data:this.data}}};o=Q;var X="AI_EmptyResponseBodyError",ee=`vercel.ai.error.${X}`,et=Symbol.for(ee),er=class extends W{constructor({message:e="Empty response body"}={}){super({name:X,message:e}),this[l]=!0}static isInstance(e){return W.hasMarker(e,ee)}static isEmptyResponseBodyError(e){return e instanceof Error&&e.name===X}};function ea(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}l=et;var es="AI_InvalidArgumentError",en=`vercel.ai.error.${es}`,ei=Symbol.for(en),eo=class extends W{constructor({message:e,cause:t,argument:r}){super({name:es,message:e,cause:t}),this[u]=!0,this.argument=r}static isInstance(e){return W.hasMarker(e,en)}};u=ei;var el="AI_InvalidPromptError",eu=`vercel.ai.error.${el}`,ec=Symbol.for(eu),ed=class extends W{constructor({prompt:e,message:t,cause:r}){super({name:el,message:`Invalid prompt: ${t}`,cause:r}),this[c]=!0,this.prompt=e}static isInstance(e){return W.hasMarker(e,eu)}static isInvalidPromptError(e){return e instanceof Error&&e.name===el&&null!=prompt}toJSON(){return{name:this.name,message:this.message,stack:this.stack,prompt:this.prompt}}};c=ec,Symbol.for("vercel.ai.error.AI_InvalidResponseDataError");var ep="AI_JSONParseError",em=`vercel.ai.error.${ep}`,eh=Symbol.for(em),ef=class extends W{constructor({text:e,cause:t}){super({name:ep,message:`JSON parsing failed: Text: ${e}.
Error message: ${ea(t)}`,cause:t}),this[d]=!0,this.text=e}static isInstance(e){return W.hasMarker(e,em)}static isJSONParseError(e){return e instanceof Error&&e.name===ep&&"text"in e&&"string"==typeof e.text}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,valueText:this.text}}};d=eh;var ey="AI_LoadAPIKeyError",eg=`vercel.ai.error.${ey}`,ev=Symbol.for(eg),e_=class extends W{constructor({message:e}){super({name:ey,message:e}),this[p]=!0}static isInstance(e){return W.hasMarker(e,eg)}static isLoadAPIKeyError(e){return e instanceof Error&&e.name===ey}};p=ev,Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError");var eb="AI_NoSuchModelError",ew=`vercel.ai.error.${eb}`,ex=Symbol.for(ew),ek=class extends W{constructor({errorName:e=eb,modelId:t,modelType:r,message:a=`No such ${r}: ${t}`}){super({name:e,message:a}),this[m]=!0,this.modelId=t,this.modelType=r}static isInstance(e){return W.hasMarker(e,ew)}static isNoSuchModelError(e){return e instanceof Error&&e.name===eb&&"string"==typeof e.modelId&&"string"==typeof e.modelType}toJSON(){return{name:this.name,message:this.message,stack:this.stack,modelId:this.modelId,modelType:this.modelType}}};m=ex,Symbol.for("vercel.ai.error.AI_TooManyEmbeddingValuesForCallError");var eT="AI_TypeValidationError",eS=`vercel.ai.error.${eT}`,eA=Symbol.for(eS),eI=class e extends W{constructor({value:e,cause:t}){super({name:eT,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${ea(t)}`,cause:t}),this[h]=!0,this.value=e}static isInstance(e){return W.hasMarker(e,eS)}static wrap({value:t,cause:r}){return e.isInstance(r)&&r.value===t?r:new e({value:t,cause:r})}static isTypeValidationError(e){return e instanceof Error&&e.name===eT}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,value:this.value}}};h=eA;var eC="AI_UnsupportedFunctionalityError",eE=`vercel.ai.error.${eC}`,eN=Symbol.for(eE),eR=class extends W{constructor({functionality:e}){super({name:eC,message:`'${e}' functionality not supported.`}),this[f]=!0,this.functionality=e}static isInstance(e){return W.hasMarker(e,eE)}static isUnsupportedFunctionalityError(e){return e instanceof Error&&e.name===eC&&"string"==typeof e.functionality}toJSON(){return{name:this.name,message:this.message,stack:this.stack,functionality:this.functionality}}};f=eN;var eO=e.i(76909);let ej=[239,187,191];class eZ extends TransformStream{constructor(){let e;super({start(t){e=function(e){let t,r,a,s,n,i,o;return l(),{feed:function(l){var u;r=r?r+l:l,t&&(u=r,ej.every((e,t)=>u.charCodeAt(t)===e))&&(r=r.slice(ej.length)),t=!1;let c=r.length,d=0,p=!1;for(;d<c;){let t;p&&("\n"===r[d]&&++d,p=!1);let l=-1,u=s;for(let e=a;l<0&&e<c;++e)":"===(t=r[e])&&u<0?u=e-d:"\r"===t?(p=!0,l=e-d):"\n"===t&&(l=e-d);if(l<0){a=c-d,s=u;break}a=0,s=-1,function(t,r,a,s){if(0===s){o.length>0&&(e({type:"event",id:n,event:i||void 0,data:o.slice(0,-1)}),o="",n=void 0),i=void 0;return}let l=a<0,u=t.slice(r,r+(l?s:a)),c=0;c=l?s:" "===t[r+a+1]?a+2:a+1;let d=r+c,p=s-c,m=t.slice(d,d+p).toString();if("data"===u)o+=m?"".concat(m,"\n"):"\n";else if("event"===u)i=m;else if("id"!==u||m.includes("\0")){if("retry"===u){let t=parseInt(m,10);Number.isNaN(t)||e({type:"reconnect-interval",value:t})}}else n=m}(r,d,u,l),d+=l+1}d===c?r="":d>0&&(r=r.slice(d))},reset:l};function l(){t=!0,r="",a=0,s=-1,n=void 0,i=void 0,o=""}}(e=>{"event"===e.type&&t.enqueue(e)})},transform(t){e.feed(t)}})}}function eP(e){let t={};return e.headers.forEach((e,r)=>{t[r]=e}),t}var eM=({prefix:e,size:t=7,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:a="-"}={})=>{let s=((e,t=21)=>(r=t)=>{let a="",s=0|r;for(;s--;)a+=e[Math.random()*e.length|0];return a})(r,t);if(null==e)return s;if(r.includes(a))throw new eo({argument:"separator",message:`The separator "${a}" must not be part of the alphabet "${r}".`});return t=>`${e}${a}${s(t)}`},e$=eM();function eD(e){return e instanceof Error&&("AbortError"===e.name||"TimeoutError"===e.name)}var eU=Symbol.for("vercel.ai.validator");function eq({value:e,schema:t}){var r;let a="object"==typeof t&&null!==t&&eU in t&&!0===t[eU]&&"validate"in t?t:(r=t,{[eU]:!0,validate:e=>{let t=r.safeParse(e);return t.success?{success:!0,value:t.data}:{success:!1,error:t.error}}});try{if(null==a.validate)return{success:!0,value:e};let t=a.validate(e);if(t.success)return t;return{success:!1,error:eI.wrap({value:e,cause:t.error})}}catch(t){return{success:!1,error:eI.wrap({value:e,cause:t})}}}function eF({text:e,schema:t}){try{let r=eO.default.parse(e);if(null==t)return{success:!0,value:r};return eq({value:r,schema:t})}catch(t){return{success:!1,error:ef.isJSONParseError(t)?t:new ef({text:e,cause:t})}}}var eL=()=>globalThis.fetch,ez=async({url:e,headers:t,body:r,failedResponseHandler:a,successfulResponseHandler:s,abortSignal:n,fetch:i})=>eB({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(r),values:r},failedResponseHandler:a,successfulResponseHandler:s,abortSignal:n,fetch:i}),eB=async({url:e,headers:t={},body:r,successfulResponseHandler:a,failedResponseHandler:s,abortSignal:n,fetch:i=eL()})=>{try{let o=await i(e,{method:"POST",headers:Object.fromEntries(Object.entries(t).filter(([e,t])=>null!=t)),body:r.content,signal:n}),l=eP(o);if(!o.ok){let t;try{t=await s({response:o,url:e,requestBodyValues:r.values})}catch(t){if(eD(t)||G.isAPICallError(t))throw t;throw new G({message:"Failed to process error response",cause:t,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:r.values})}throw t.value}try{return await a({response:o,url:e,requestBodyValues:r.values})}catch(t){if(t instanceof Error&&(eD(t)||G.isAPICallError(t)))throw t;throw new G({message:"Failed to process successful response",cause:t,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:r.values})}}catch(t){if(eD(t))throw t;if(t instanceof TypeError&&"fetch failed"===t.message){let a=t.cause;if(null!=a)throw new G({message:`Cannot connect to API: ${a.message}`,cause:a,url:e,requestBodyValues:r.values,isRetryable:!0})}throw t}},{btoa:eV,atob:eH}=globalThis;function eJ(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return eV(t)}let eW=Symbol("Let zodToJsonSchema decide on which parser to use"),eK={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"};function eY(e,t,r,a){a?.errorMessages&&r&&(e.errorMessage={...e.errorMessage,[t]:r})}function eQ(e,t,r,a,s){e[t]=r,eY(e,t,a,s)}let eG=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")};(a=y||(y={})).assertEqual=e=>{},a.assertIs=function(e){},a.assertNever=function(e){throw Error()},a.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},a.getValidEnumValues=e=>{let t=a.objectKeys(e).filter(t=>"number"!=typeof e[e[t]]),r={};for(let a of t)r[a]=e[a];return a.objectValues(r)},a.objectValues=e=>a.objectKeys(e).map(function(t){return e[t]}),a.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},a.find=(e,t)=>{for(let r of e)if(t(r))return r},a.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,a.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},a.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t,(g||(g={})).mergeShapes=(e,t)=>({...e,...t});let eX=y.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),e0=e=>{switch(typeof e){case"undefined":return eX.undefined;case"string":return eX.string;case"number":return Number.isNaN(e)?eX.nan:eX.number;case"boolean":return eX.boolean;case"function":return eX.function;case"bigint":return eX.bigint;case"symbol":return eX.symbol;case"object":if(Array.isArray(e))return eX.array;if(null===e)return eX.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return eX.promise;if("u">typeof Map&&e instanceof Map)return eX.map;if("u">typeof Set&&e instanceof Set)return eX.set;if("u">typeof Date&&e instanceof Date)return eX.date;return eX.object;default:return eX.unknown}};e.s(["ZodParsedType",0,eX,"getParsedType",0,e0,"objectUtil",()=>g,"util",()=>y],53557);let e1=y.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),e2=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class e9 extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},r={_errors:[]},a=e=>{for(let s of e.issues)if("invalid_union"===s.code)s.unionErrors.map(a);else if("invalid_return_type"===s.code)a(s.returnTypeError);else if("invalid_arguments"===s.code)a(s.argumentsError);else if(0===s.path.length)r._errors.push(t(s));else{let e=r,a=0;for(;a<s.path.length;){let r=s.path[a];a===s.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(s))):e[r]=e[r]||{_errors:[]},e=e[r],a++}}};return a(this),r}static assert(e){if(!(e instanceof e9))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,y.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let a of this.issues)if(a.path.length>0){let r=a.path[0];t[r]=t[r]||[],t[r].push(e(a))}else r.push(e(a));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}e9.create=e=>new e9(e),e.s(["ZodError",()=>e9,"ZodIssueCode",0,e1,"quotelessJson",0,e2],66502);let e4=(e,t)=>{let r;switch(e.code){case e1.invalid_type:r=e.received===eX.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case e1.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,y.jsonStringifyReplacer)}`;break;case e1.unrecognized_keys:r=`Unrecognized key(s) in object: ${y.joinValues(e.keys,", ")}`;break;case e1.invalid_union:r="Invalid input";break;case e1.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${y.joinValues(e.options)}`;break;case e1.invalid_enum_value:r=`Invalid enum value. Expected ${y.joinValues(e.options)}, received '${e.received}'`;break;case e1.invalid_arguments:r="Invalid function arguments";break;case e1.invalid_return_type:r="Invalid function return type";break;case e1.invalid_date:r="Invalid date";break;case e1.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:y.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case e1.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type||"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case e1.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case e1.custom:r="Invalid input";break;case e1.invalid_intersection_types:r="Intersection results could not be merged";break;case e1.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case e1.not_finite:r="Number must be finite";break;default:r=t.defaultError,y.assertNever(e)}return{message:r}},e6=e4;function e5(e){e6=e}function e3(){return e6}e.s(["getErrorMap",()=>e3,"setErrorMap",()=>e5],52610),(s=v||(v={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},s.toString=e=>"string"==typeof e?e:e?.message;let e7=e=>{let{data:t,path:r,errorMaps:a,issueData:s}=e,n=[...r,...s.path||[]],i={...s,path:n};if(void 0!==s.message)return{...s,path:n,message:s.message};let o="";for(let e of a.filter(e=>!!e).slice().reverse())o=e(i,{data:t,defaultError:o}).message;return{...s,path:n,message:o}},e8=[];function te(e,t){let r=e6,a=e7({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===e4?void 0:e4].filter(e=>!!e)});e.common.issues.push(a)}class tt{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let a of t){if("aborted"===a.status)return tr;"dirty"===a.status&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){let r=[];for(let e of t){let t=await e.key,a=await e.value;r.push({key:t,value:a})}return tt.mergeObjectSync(e,r)}static mergeObjectSync(e,t){let r={};for(let a of t){let{key:t,value:s}=a;if("aborted"===t.status||"aborted"===s.status)return tr;"dirty"===t.status&&e.dirty(),"dirty"===s.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==s.value||a.alwaysSet)&&(r[t.value]=s.value)}return{status:e.value,value:r}}}let tr=Object.freeze({status:"aborted"}),ta=e=>({status:"dirty",value:e}),ts=e=>({status:"valid",value:e}),tn=e=>"aborted"===e.status,ti=e=>"dirty"===e.status,to=e=>"valid"===e.status,tl=e=>"u">typeof Promise&&e instanceof Promise;e.s(["DIRTY",0,ta,"EMPTY_PATH",0,e8,"INVALID",0,tr,"OK",0,ts,"ParseStatus",()=>tt,"addIssueToContext",()=>te,"isAborted",0,tn,"isAsync",0,tl,"isDirty",0,ti,"isValid",0,to,"makeIssue",0,e7],3955);class tu{constructor(e,t,r,a){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let tc=(e,t)=>{if(to(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new e9(e.common.issues);return this._error=t,this._error}}};function td(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:a,description:s}=e;if(t&&(r||a))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:s}:{errorMap:(t,s)=>{let{message:n}=e;return"invalid_enum_value"===t.code?{message:n??s.defaultError}:void 0===s.data?{message:n??a??s.defaultError}:"invalid_type"!==t.code?{message:s.defaultError}:{message:n??r??s.defaultError}},description:s}}class tp{get description(){return this._def.description}_getType(e){return e0(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:e0(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new tt,ctx:{common:e.parent.common,data:e.data,parsedType:e0(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(tl(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){let r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:e0(e)},a=this._parseSync({data:e,path:r.path,parent:r});return tc(r,a)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:e0(e)};if(!this["~standard"].async)try{let r=this._parseSync({data:e,path:[],parent:t});return to(r)?{value:r.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>to(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:e0(e)},a=this._parse({data:e,path:r.path,parent:r});return tc(r,await (tl(a)?a:Promise.resolve(a)))}refine(e,t){return this._refinement((r,a)=>{let s=e(r),n=()=>a.addIssue({code:e1.custom,..."string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(r):t});return"u">typeof Promise&&s instanceof Promise?s.then(e=>!!e||(n(),!1)):!!s||(n(),!1)})}refinement(e,t){return this._refinement((r,a)=>!!e(r)||(a.addIssue("function"==typeof t?t(r,a):t),!1))}_refinement(e){return new t5({schema:this,typeName:_.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return t3.create(this,this._def)}nullable(){return t7.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return tz.create(this)}promise(){return t6.create(this,this._def)}or(e){return tV.create([this,e],this._def)}and(e){return tW.create(this,e,this._def)}transform(e){return new t5({...td(this._def),schema:this,typeName:_.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new t8({...td(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:_.ZodDefault})}brand(){return new ra({typeName:_.ZodBranded,type:this,...td(this._def)})}catch(e){return new re({...td(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:_.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return rs.create(this,e)}readonly(){return rn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let tm=/^c[^\s-]{8,}$/i,th=/^[0-9a-z]+$/,tf=/^[0-9A-HJKMNP-TV-Z]{26}$/i,ty=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,tg=/^[a-z0-9_-]{21}$/i,tv=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,t_=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,tb=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,tw=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,tx=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,tk=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,tT=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,tS=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,tA=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,tI="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",tC=RegExp(`^${tI}$`);function tE(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);let r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function tN(e){let t=`${tI}T${tE(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,RegExp(`^${t}$`)}class tR extends tp{_parse(e){var r,a,s,n;let i;if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==eX.string){let t=this._getOrReturnCtx(e);return te(t,{code:e1.invalid_type,expected:eX.string,received:t.parsedType}),tr}let o=new tt;for(let l of this._def.checks)if("min"===l.kind)e.data.length<l.value&&(te(i=this._getOrReturnCtx(e,i),{code:e1.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),o.dirty());else if("max"===l.kind)e.data.length>l.value&&(te(i=this._getOrReturnCtx(e,i),{code:e1.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),o.dirty());else if("length"===l.kind){let t=e.data.length>l.value,r=e.data.length<l.value;(t||r)&&(i=this._getOrReturnCtx(e,i),t?te(i,{code:e1.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):r&&te(i,{code:e1.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),o.dirty())}else if("email"===l.kind)tb.test(e.data)||(te(i=this._getOrReturnCtx(e,i),{validation:"email",code:e1.invalid_string,message:l.message}),o.dirty());else if("emoji"===l.kind)t||(t=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),t.test(e.data)||(te(i=this._getOrReturnCtx(e,i),{validation:"emoji",code:e1.invalid_string,message:l.message}),o.dirty());else if("uuid"===l.kind)ty.test(e.data)||(te(i=this._getOrReturnCtx(e,i),{validation:"uuid",code:e1.invalid_string,message:l.message}),o.dirty());else if("nanoid"===l.kind)tg.test(e.data)||(te(i=this._getOrReturnCtx(e,i),{validation:"nanoid",code:e1.invalid_string,message:l.message}),o.dirty());else if("cuid"===l.kind)tm.test(e.data)||(te(i=this._getOrReturnCtx(e,i),{validation:"cuid",code:e1.invalid_string,message:l.message}),o.dirty());else if("cuid2"===l.kind)th.test(e.data)||(te(i=this._getOrReturnCtx(e,i),{validation:"cuid2",code:e1.invalid_string,message:l.message}),o.dirty());else if("ulid"===l.kind)tf.test(e.data)||(te(i=this._getOrReturnCtx(e,i),{validation:"ulid",code:e1.invalid_string,message:l.message}),o.dirty());else if("url"===l.kind)try{new URL(e.data)}catch{te(i=this._getOrReturnCtx(e,i),{validation:"url",code:e1.invalid_string,message:l.message}),o.dirty()}else"regex"===l.kind?(l.regex.lastIndex=0,l.regex.test(e.data)||(te(i=this._getOrReturnCtx(e,i),{validation:"regex",code:e1.invalid_string,message:l.message}),o.dirty())):"trim"===l.kind?e.data=e.data.trim():"includes"===l.kind?e.data.includes(l.value,l.position)||(te(i=this._getOrReturnCtx(e,i),{code:e1.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),o.dirty()):"toLowerCase"===l.kind?e.data=e.data.toLowerCase():"toUpperCase"===l.kind?e.data=e.data.toUpperCase():"startsWith"===l.kind?e.data.startsWith(l.value)||(te(i=this._getOrReturnCtx(e,i),{code:e1.invalid_string,validation:{startsWith:l.value},message:l.message}),o.dirty()):"endsWith"===l.kind?e.data.endsWith(l.value)||(te(i=this._getOrReturnCtx(e,i),{code:e1.invalid_string,validation:{endsWith:l.value},message:l.message}),o.dirty()):"datetime"===l.kind?tN(l).test(e.data)||(te(i=this._getOrReturnCtx(e,i),{code:e1.invalid_string,validation:"datetime",message:l.message}),o.dirty()):"date"===l.kind?tC.test(e.data)||(te(i=this._getOrReturnCtx(e,i),{code:e1.invalid_string,validation:"date",message:l.message}),o.dirty()):"time"===l.kind?RegExp(`^${tE(l)}$`).test(e.data)||(te(i=this._getOrReturnCtx(e,i),{code:e1.invalid_string,validation:"time",message:l.message}),o.dirty()):"duration"===l.kind?t_.test(e.data)||(te(i=this._getOrReturnCtx(e,i),{validation:"duration",code:e1.invalid_string,message:l.message}),o.dirty()):"ip"===l.kind?(r=e.data,!(("v4"===(a=l.version)||!a)&&tw.test(r)||("v6"===a||!a)&&tk.test(r))&&1&&(te(i=this._getOrReturnCtx(e,i),{validation:"ip",code:e1.invalid_string,message:l.message}),o.dirty())):"jwt"===l.kind?!function(e,t){if(!tv.test(e))return!1;try{let[r]=e.split(".");if(!r)return!1;let a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(a));if("object"!=typeof s||null===s||"typ"in s&&s?.typ!=="JWT"||!s.alg||t&&s.alg!==t)return!1;return!0}catch{return!1}}(e.data,l.alg)&&(te(i=this._getOrReturnCtx(e,i),{validation:"jwt",code:e1.invalid_string,message:l.message}),o.dirty()):"cidr"===l.kind?(s=e.data,!(("v4"===(n=l.version)||!n)&&tx.test(s)||("v6"===n||!n)&&tT.test(s))&&1&&(te(i=this._getOrReturnCtx(e,i),{validation:"cidr",code:e1.invalid_string,message:l.message}),o.dirty())):"base64"===l.kind?tS.test(e.data)||(te(i=this._getOrReturnCtx(e,i),{validation:"base64",code:e1.invalid_string,message:l.message}),o.dirty()):"base64url"===l.kind?tA.test(e.data)||(te(i=this._getOrReturnCtx(e,i),{validation:"base64url",code:e1.invalid_string,message:l.message}),o.dirty()):y.assertNever(l);return{status:o.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:e1.invalid_string,...v.errToObj(r)})}_addCheck(e){return new tR({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...v.errToObj(e)})}url(e){return this._addCheck({kind:"url",...v.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...v.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...v.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...v.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...v.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...v.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...v.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...v.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...v.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...v.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...v.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...v.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...v.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...v.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...v.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...v.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...v.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...v.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...v.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...v.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...v.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...v.errToObj(t)})}nonempty(e){return this.min(1,v.errToObj(e))}trim(){return new tR({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new tR({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new tR({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}tR.create=e=>new tR({checks:[],typeName:_.ZodString,coerce:e?.coerce??!1,...td(e)});class tO extends tp{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==eX.number){let t=this._getOrReturnCtx(e);return te(t,{code:e1.invalid_type,expected:eX.number,received:t.parsedType}),tr}let r=new tt;for(let a of this._def.checks)"int"===a.kind?y.isInteger(e.data)||(te(t=this._getOrReturnCtx(e,t),{code:e1.invalid_type,expected:"integer",received:"float",message:a.message}),r.dirty()):"min"===a.kind?(a.inclusive?e.data<a.value:e.data<=a.value)&&(te(t=this._getOrReturnCtx(e,t),{code:e1.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):"max"===a.kind?(a.inclusive?e.data>a.value:e.data>=a.value)&&(te(t=this._getOrReturnCtx(e,t),{code:e1.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):"multipleOf"===a.kind?0!==function(e,t){let r=(e.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,s=r>a?r:a;return Number.parseInt(e.toFixed(s).replace(".",""))%Number.parseInt(t.toFixed(s).replace(".",""))/10**s}(e.data,a.value)&&(te(t=this._getOrReturnCtx(e,t),{code:e1.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):"finite"===a.kind?Number.isFinite(e.data)||(te(t=this._getOrReturnCtx(e,t),{code:e1.not_finite,message:a.message}),r.dirty()):y.assertNever(a);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,v.toString(t))}gt(e,t){return this.setLimit("min",e,!1,v.toString(t))}lte(e,t){return this.setLimit("max",e,!0,v.toString(t))}lt(e,t){return this.setLimit("max",e,!1,v.toString(t))}setLimit(e,t,r,a){return new tO({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:v.toString(a)}]})}_addCheck(e){return new tO({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:v.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:v.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:v.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:v.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:v.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:v.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:v.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:v.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:v.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&y.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks)if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;else"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value);return Number.isFinite(t)&&Number.isFinite(e)}}tO.create=e=>new tO({checks:[],typeName:_.ZodNumber,coerce:e?.coerce||!1,...td(e)});class tj extends tp{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==eX.bigint)return this._getInvalidInput(e);let r=new tt;for(let a of this._def.checks)"min"===a.kind?(a.inclusive?e.data<a.value:e.data<=a.value)&&(te(t=this._getOrReturnCtx(e,t),{code:e1.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):"max"===a.kind?(a.inclusive?e.data>a.value:e.data>=a.value)&&(te(t=this._getOrReturnCtx(e,t),{code:e1.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):"multipleOf"===a.kind?e.data%a.value!==BigInt(0)&&(te(t=this._getOrReturnCtx(e,t),{code:e1.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):y.assertNever(a);return{status:r.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return te(t,{code:e1.invalid_type,expected:eX.bigint,received:t.parsedType}),tr}gte(e,t){return this.setLimit("min",e,!0,v.toString(t))}gt(e,t){return this.setLimit("min",e,!1,v.toString(t))}lte(e,t){return this.setLimit("max",e,!0,v.toString(t))}lt(e,t){return this.setLimit("max",e,!1,v.toString(t))}setLimit(e,t,r,a){return new tj({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:v.toString(a)}]})}_addCheck(e){return new tj({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:v.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:v.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:v.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:v.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:v.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}tj.create=e=>new tj({checks:[],typeName:_.ZodBigInt,coerce:e?.coerce??!1,...td(e)});class tZ extends tp{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==eX.boolean){let t=this._getOrReturnCtx(e);return te(t,{code:e1.invalid_type,expected:eX.boolean,received:t.parsedType}),tr}return ts(e.data)}}tZ.create=e=>new tZ({typeName:_.ZodBoolean,coerce:e?.coerce||!1,...td(e)});class tP extends tp{_parse(e){let t;if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==eX.date){let t=this._getOrReturnCtx(e);return te(t,{code:e1.invalid_type,expected:eX.date,received:t.parsedType}),tr}if(Number.isNaN(e.data.getTime()))return te(this._getOrReturnCtx(e),{code:e1.invalid_date}),tr;let r=new tt;for(let a of this._def.checks)"min"===a.kind?e.data.getTime()<a.value&&(te(t=this._getOrReturnCtx(e,t),{code:e1.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):"max"===a.kind?e.data.getTime()>a.value&&(te(t=this._getOrReturnCtx(e,t),{code:e1.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):y.assertNever(a);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new tP({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:v.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:v.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}tP.create=e=>new tP({checks:[],coerce:e?.coerce||!1,typeName:_.ZodDate,...td(e)});class tM extends tp{_parse(e){if(this._getType(e)!==eX.symbol){let t=this._getOrReturnCtx(e);return te(t,{code:e1.invalid_type,expected:eX.symbol,received:t.parsedType}),tr}return ts(e.data)}}tM.create=e=>new tM({typeName:_.ZodSymbol,...td(e)});class t$ extends tp{_parse(e){if(this._getType(e)!==eX.undefined){let t=this._getOrReturnCtx(e);return te(t,{code:e1.invalid_type,expected:eX.undefined,received:t.parsedType}),tr}return ts(e.data)}}t$.create=e=>new t$({typeName:_.ZodUndefined,...td(e)});class tD extends tp{_parse(e){if(this._getType(e)!==eX.null){let t=this._getOrReturnCtx(e);return te(t,{code:e1.invalid_type,expected:eX.null,received:t.parsedType}),tr}return ts(e.data)}}tD.create=e=>new tD({typeName:_.ZodNull,...td(e)});class tU extends tp{constructor(){super(...arguments),this._any=!0}_parse(e){return ts(e.data)}}tU.create=e=>new tU({typeName:_.ZodAny,...td(e)});class tq extends tp{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ts(e.data)}}tq.create=e=>new tq({typeName:_.ZodUnknown,...td(e)});class tF extends tp{_parse(e){let t=this._getOrReturnCtx(e);return te(t,{code:e1.invalid_type,expected:eX.never,received:t.parsedType}),tr}}tF.create=e=>new tF({typeName:_.ZodNever,...td(e)});class tL extends tp{_parse(e){if(this._getType(e)!==eX.undefined){let t=this._getOrReturnCtx(e);return te(t,{code:e1.invalid_type,expected:eX.void,received:t.parsedType}),tr}return ts(e.data)}}tL.create=e=>new tL({typeName:_.ZodVoid,...td(e)});class tz extends tp{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),a=this._def;if(t.parsedType!==eX.array)return te(t,{code:e1.invalid_type,expected:eX.array,received:t.parsedType}),tr;if(null!==a.exactLength){let e=t.data.length>a.exactLength.value,s=t.data.length<a.exactLength.value;(e||s)&&(te(t,{code:e?e1.too_big:e1.too_small,minimum:s?a.exactLength.value:void 0,maximum:e?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(null!==a.minLength&&t.data.length<a.minLength.value&&(te(t,{code:e1.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),null!==a.maxLength&&t.data.length>a.maxLength.value&&(te(t,{code:e1.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>a.type._parseAsync(new tu(t,e,t.path,r)))).then(e=>tt.mergeArray(r,e));let s=[...t.data].map((e,r)=>a.type._parseSync(new tu(t,e,t.path,r)));return tt.mergeArray(r,s)}get element(){return this._def.type}min(e,t){return new tz({...this._def,minLength:{value:e,message:v.toString(t)}})}max(e,t){return new tz({...this._def,maxLength:{value:e,message:v.toString(t)}})}length(e,t){return new tz({...this._def,exactLength:{value:e,message:v.toString(t)}})}nonempty(e){return this.min(1,e)}}tz.create=(e,t)=>new tz({type:e,minLength:null,maxLength:null,exactLength:null,typeName:_.ZodArray,...td(t)});class tB extends tp{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=y.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==eX.object){let t=this._getOrReturnCtx(e);return te(t,{code:e1.invalid_type,expected:eX.object,received:t.parsedType}),tr}let{status:t,ctx:r}=this._processInputParams(e),{shape:a,keys:s}=this._getCached(),n=[];if(!(this._def.catchall instanceof tF&&"strip"===this._def.unknownKeys))for(let e in r.data)s.includes(e)||n.push(e);let i=[];for(let e of s){let t=a[e],s=r.data[e];i.push({key:{status:"valid",value:e},value:t._parse(new tu(r,s,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof tF){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of n)i.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)n.length>0&&(te(r,{code:e1.unrecognized_keys,keys:n}),t.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of n){let a=r.data[t];i.push({key:{status:"valid",value:t},value:e._parse(new tu(r,a,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of i){let r=await t.key,a=await t.value;e.push({key:r,value:a,alwaysSet:t.alwaysSet})}return e}).then(e=>tt.mergeObjectSync(t,e)):tt.mergeObjectSync(t,i)}get shape(){return this._def.shape()}strict(e){return v.errToObj,new tB({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{let a=this._def.errorMap?.(t,r).message??r.defaultError;return"unrecognized_keys"===t.code?{message:v.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new tB({...this._def,unknownKeys:"strip"})}passthrough(){return new tB({...this._def,unknownKeys:"passthrough"})}extend(e){return new tB({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new tB({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:_.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new tB({...this._def,catchall:e})}pick(e){let t={};for(let r of y.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new tB({...this._def,shape:()=>t})}omit(e){let t={};for(let r of y.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new tB({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof tB){let r={};for(let a in t.shape){let s=t.shape[a];r[a]=t3.create(e(s))}return new tB({...t._def,shape:()=>r})}if(t instanceof tz)return new tz({...t._def,type:e(t.element)});if(t instanceof t3)return t3.create(e(t.unwrap()));if(t instanceof t7)return t7.create(e(t.unwrap()));if(t instanceof tK)return tK.create(t.items.map(t=>e(t)));else return t}(this)}partial(e){let t={};for(let r of y.objectKeys(this.shape)){let a=this.shape[r];e&&!e[r]?t[r]=a:t[r]=a.optional()}return new tB({...this._def,shape:()=>t})}required(e){let t={};for(let r of y.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof t3;)e=e._def.innerType;t[r]=e}return new tB({...this._def,shape:()=>t})}keyof(){return t2(y.objectKeys(this.shape))}}tB.create=(e,t)=>new tB({shape:()=>e,unknownKeys:"strip",catchall:tF.create(),typeName:_.ZodObject,...td(t)}),tB.strictCreate=(e,t)=>new tB({shape:()=>e,unknownKeys:"strict",catchall:tF.create(),typeName:_.ZodObject,...td(t)}),tB.lazycreate=(e,t)=>new tB({shape:e,unknownKeys:"strip",catchall:tF.create(),typeName:_.ZodObject,...td(t)});class tV extends tp{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new e9(e.ctx.common.issues));return te(t,{code:e1.invalid_union,unionErrors:r}),tr});{let e,a=[];for(let s of r){let r={...t,common:{...t.common,issues:[]},parent:null},n=s._parseSync({data:t.data,path:t.path,parent:r});if("valid"===n.status)return n;"dirty"!==n.status||e||(e={result:n,ctx:r}),r.common.issues.length&&a.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let s=a.map(e=>new e9(e));return te(t,{code:e1.invalid_union,unionErrors:s}),tr}}get options(){return this._def.options}}tV.create=(e,t)=>new tV({options:e,typeName:_.ZodUnion,...td(t)});let tH=e=>{if(e instanceof t0)return tH(e.schema);if(e instanceof t5)return tH(e.innerType());if(e instanceof t1)return[e.value];if(e instanceof t9)return e.options;if(e instanceof t4)return y.objectValues(e.enum);else if(e instanceof t8)return tH(e._def.innerType);else if(e instanceof t$)return[void 0];else if(e instanceof tD)return[null];else if(e instanceof t3)return[void 0,...tH(e.unwrap())];else if(e instanceof t7)return[null,...tH(e.unwrap())];else if(e instanceof ra)return tH(e.unwrap());else if(e instanceof rn)return tH(e.unwrap());else if(e instanceof re)return tH(e._def.innerType);else return[]};class tJ extends tp{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==eX.object)return te(t,{code:e1.invalid_type,expected:eX.object,received:t.parsedType}),tr;let r=this.discriminator,a=t.data[r],s=this.optionsMap.get(a);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(te(t,{code:e1.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),tr)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let a=new Map;for(let r of t){let t=tH(r.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let s of t){if(a.has(s))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(s)}`);a.set(s,r)}}return new tJ({typeName:_.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:a,...td(r)})}}class tW extends tp{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),a=(e,a)=>{if(tn(e)||tn(a))return tr;let s=function e(t,r){let a=e0(t),s=e0(r);if(t===r)return{valid:!0,data:t};if(a===eX.object&&s===eX.object){let a=y.objectKeys(r),s=y.objectKeys(t).filter(e=>-1!==a.indexOf(e)),n={...t,...r};for(let a of s){let s=e(t[a],r[a]);if(!s.valid)return{valid:!1};n[a]=s.data}return{valid:!0,data:n}}if(a===eX.array&&s===eX.array){if(t.length!==r.length)return{valid:!1};let a=[];for(let s=0;s<t.length;s++){let n=e(t[s],r[s]);if(!n.valid)return{valid:!1};a.push(n.data)}return{valid:!0,data:a}}if(a===eX.date&&s===eX.date&&+t==+r)return{valid:!0,data:t};return{valid:!1}}(e.value,a.value);return s.valid?((ti(e)||ti(a))&&t.dirty(),{status:t.value,value:s.data}):(te(r,{code:e1.invalid_intersection_types}),tr)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>a(e,t)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}tW.create=(e,t,r)=>new tW({left:e,right:t,typeName:_.ZodIntersection,...td(r)});class tK extends tp{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==eX.array)return te(r,{code:e1.invalid_type,expected:eX.array,received:r.parsedType}),tr;if(r.data.length<this._def.items.length)return te(r,{code:e1.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),tr;!this._def.rest&&r.data.length>this._def.items.length&&(te(r,{code:e1.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let a=[...r.data].map((e,t)=>{let a=this._def.items[t]||this._def.rest;return a?a._parse(new tu(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(a).then(e=>tt.mergeArray(t,e)):tt.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new tK({...this._def,rest:e})}}tK.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new tK({items:e,typeName:_.ZodTuple,rest:null,...td(t)})};class tY extends tp{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==eX.object)return te(r,{code:e1.invalid_type,expected:eX.object,received:r.parsedType}),tr;let a=[],s=this._def.keyType,n=this._def.valueType;for(let e in r.data)a.push({key:s._parse(new tu(r,e,r.path,e)),value:n._parse(new tu(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?tt.mergeObjectAsync(t,a):tt.mergeObjectSync(t,a)}get element(){return this._def.valueType}static create(e,t,r){return new tY(t instanceof tp?{keyType:e,valueType:t,typeName:_.ZodRecord,...td(r)}:{keyType:tR.create(),valueType:e,typeName:_.ZodRecord,...td(t)})}}class tQ extends tp{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==eX.map)return te(r,{code:e1.invalid_type,expected:eX.map,received:r.parsedType}),tr;let a=this._def.keyType,s=this._def.valueType,n=[...r.data.entries()].map(([e,t],n)=>({key:a._parse(new tu(r,e,r.path,[n,"key"])),value:s._parse(new tu(r,t,r.path,[n,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of n){let a=await r.key,s=await r.value;if("aborted"===a.status||"aborted"===s.status)return tr;("dirty"===a.status||"dirty"===s.status)&&t.dirty(),e.set(a.value,s.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of n){let a=r.key,s=r.value;if("aborted"===a.status||"aborted"===s.status)return tr;("dirty"===a.status||"dirty"===s.status)&&t.dirty(),e.set(a.value,s.value)}return{status:t.value,value:e}}}}tQ.create=(e,t,r)=>new tQ({valueType:t,keyType:e,typeName:_.ZodMap,...td(r)});class tG extends tp{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==eX.set)return te(r,{code:e1.invalid_type,expected:eX.set,received:r.parsedType}),tr;let a=this._def;null!==a.minSize&&r.data.size<a.minSize.value&&(te(r,{code:e1.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),t.dirty()),null!==a.maxSize&&r.data.size>a.maxSize.value&&(te(r,{code:e1.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),t.dirty());let s=this._def.valueType;function n(e){let r=new Set;for(let a of e){if("aborted"===a.status)return tr;"dirty"===a.status&&t.dirty(),r.add(a.value)}return{status:t.value,value:r}}let i=[...r.data.values()].map((e,t)=>s._parse(new tu(r,e,r.path,t)));return r.common.async?Promise.all(i).then(e=>n(e)):n(i)}min(e,t){return new tG({...this._def,minSize:{value:e,message:v.toString(t)}})}max(e,t){return new tG({...this._def,maxSize:{value:e,message:v.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}tG.create=(e,t)=>new tG({valueType:e,minSize:null,maxSize:null,typeName:_.ZodSet,...td(t)});class tX extends tp{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==eX.function)return te(t,{code:e1.invalid_type,expected:eX.function,received:t.parsedType}),tr;function r(e,r){return e7({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,e6,e4].filter(e=>!!e),issueData:{code:e1.invalid_arguments,argumentsError:r}})}function a(e,r){return e7({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,e6,e4].filter(e=>!!e),issueData:{code:e1.invalid_return_type,returnTypeError:r}})}let s={errorMap:t.common.contextualErrorMap},n=t.data;if(this._def.returns instanceof t6){let e=this;return ts(async function(...t){let i=new e9([]),o=await e._def.args.parseAsync(t,s).catch(e=>{throw i.addIssue(r(t,e)),i}),l=await Reflect.apply(n,this,o);return await e._def.returns._def.type.parseAsync(l,s).catch(e=>{throw i.addIssue(a(l,e)),i})})}{let e=this;return ts(function(...t){let i=e._def.args.safeParse(t,s);if(!i.success)throw new e9([r(t,i.error)]);let o=Reflect.apply(n,this,i.data),l=e._def.returns.safeParse(o,s);if(!l.success)throw new e9([a(o,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new tX({...this._def,args:tK.create(e).rest(tq.create())})}returns(e){return new tX({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new tX({args:e||tK.create([]).rest(tq.create()),returns:t||tq.create(),typeName:_.ZodFunction,...td(r)})}}class t0 extends tp{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}t0.create=(e,t)=>new t0({getter:e,typeName:_.ZodLazy,...td(t)});class t1 extends tp{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return te(t,{received:t.data,code:e1.invalid_literal,expected:this._def.value}),tr}return{status:"valid",value:e.data}}get value(){return this._def.value}}function t2(e,t){return new t9({values:e,typeName:_.ZodEnum,...td(t)})}t1.create=(e,t)=>new t1({value:e,typeName:_.ZodLiteral,...td(t)});class t9 extends tp{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),r=this._def.values;return te(t,{expected:y.joinValues(r),received:t.parsedType,code:e1.invalid_type}),tr}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return te(t,{received:t.data,code:e1.invalid_enum_value,options:r}),tr}return ts(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return t9.create(e,{...this._def,...t})}exclude(e,t=this._def){return t9.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}t9.create=t2;class t4 extends tp{_parse(e){let t=y.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==eX.string&&r.parsedType!==eX.number){let e=y.objectValues(t);return te(r,{expected:y.joinValues(e),received:r.parsedType,code:e1.invalid_type}),tr}if(this._cache||(this._cache=new Set(y.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let e=y.objectValues(t);return te(r,{received:r.data,code:e1.invalid_enum_value,options:e}),tr}return ts(e.data)}get enum(){return this._def.values}}t4.create=(e,t)=>new t4({values:e,typeName:_.ZodNativeEnum,...td(t)});class t6 extends tp{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);return t.parsedType!==eX.promise&&!1===t.common.async?(te(t,{code:e1.invalid_type,expected:eX.promise,received:t.parsedType}),tr):ts((t.parsedType===eX.promise?t.data:Promise.resolve(t.data)).then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}t6.create=(e,t)=>new t6({type:e,typeName:_.ZodPromise,...td(t)});class t5 extends tp{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===_.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),a=this._def.effect||null,s={addIssue:e=>{te(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),"preprocess"===a.type){let e=a.transform(r.data,s);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return tr;let a=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===a.status?tr:"dirty"===a.status||"dirty"===t.value?ta(a.value):a});{if("aborted"===t.value)return tr;let a=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===a.status?tr:"dirty"===a.status||"dirty"===t.value?ta(a.value):a}}if("refinement"===a.type){let e=e=>{let t=a.refinement(e,s);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?tr:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))));{let a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===a.status?tr:("dirty"===a.status&&t.dirty(),e(a.value),{status:t.value,value:a.value})}}if("transform"===a.type)if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>to(e)?Promise.resolve(a.transform(e.value,s)).then(e=>({status:t.value,value:e})):tr);else{let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!to(e))return tr;let n=a.transform(e.value,s);if(n instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:n}}y.assertNever(a)}}t5.create=(e,t,r)=>new t5({schema:e,typeName:_.ZodEffects,effect:t,...td(r)}),t5.createWithPreprocess=(e,t,r)=>new t5({schema:t,effect:{type:"preprocess",transform:e},typeName:_.ZodEffects,...td(r)});class t3 extends tp{_parse(e){return this._getType(e)===eX.undefined?ts(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t3.create=(e,t)=>new t3({innerType:e,typeName:_.ZodOptional,...td(t)});class t7 extends tp{_parse(e){return this._getType(e)===eX.null?ts(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t7.create=(e,t)=>new t7({innerType:e,typeName:_.ZodNullable,...td(t)});class t8 extends tp{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===eX.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}t8.create=(e,t)=>new t8({innerType:e,typeName:_.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...td(t)});class re extends tp{_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return tl(a)?a.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new e9(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new e9(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}re.create=(e,t)=>new re({innerType:e,typeName:_.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...td(t)});class rt extends tp{_parse(e){if(this._getType(e)!==eX.nan){let t=this._getOrReturnCtx(e);return te(t,{code:e1.invalid_type,expected:eX.nan,received:t.parsedType}),tr}return{status:"valid",value:e.data}}}rt.create=e=>new rt({typeName:_.ZodNaN,...td(e)});let rr=Symbol("zod_brand");class ra extends tp{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class rs extends tp{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?tr:"dirty"===e.status?(t.dirty(),ta(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?tr:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new rs({in:e,out:t,typeName:_.ZodPipeline})}}class rn extends tp{_parse(e){let t=this._def.innerType._parse(e),r=e=>(to(e)&&(e.value=Object.freeze(e.value)),e);return tl(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}function ri(e,t){let r="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof r?{message:r}:r}function ro(e,t={},r){return e?tU.create().superRefine((a,s)=>{let n=e(a);if(n instanceof Promise)return n.then(e=>{if(!e){let e=ri(t,a),n=e.fatal??r??!0;s.addIssue({code:"custom",...e,fatal:n})}});if(!n){let e=ri(t,a),n=e.fatal??r??!0;s.addIssue({code:"custom",...e,fatal:n})}}):tU.create()}rn.create=(e,t)=>new rn({innerType:e,typeName:_.ZodReadonly,...td(t)});let rl={object:tB.lazycreate};(n=_||(_={})).ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly";let ru=(e,t={message:`Input not instance of ${e.name}`})=>ro(t=>t instanceof e,t),rc=tR.create,rd=tO.create,rp=rt.create,rm=tj.create,rh=tZ.create,rf=tP.create,ry=tM.create,rg=t$.create,rv=tD.create,r_=tU.create,rb=tq.create,rw=tF.create,rx=tL.create,rk=tz.create,rT=tB.create,rS=tB.strictCreate,rA=tV.create,rI=tJ.create,rC=tW.create,rE=tK.create,rN=tY.create,rR=tQ.create,rO=tG.create,rj=tX.create,rZ=t0.create,rP=t1.create,rM=t9.create,r$=t4.create,rD=t6.create,rU=t5.create,rq=t3.create,rF=t7.create,rL=t5.createWithPreprocess,rz=rs.create,rB=()=>rc().optional(),rV=()=>rd().optional(),rH=()=>rh().optional(),rJ={string:e=>tR.create({...e,coerce:!0}),number:e=>tO.create({...e,coerce:!0}),boolean:e=>tZ.create({...e,coerce:!0}),bigint:e=>tj.create({...e,coerce:!0}),date:e=>tP.create({...e,coerce:!0})};function rW(e){if("openAi"!==e.target)return{};let t=[...e.basePath,e.definitionPath,e.openAiAnyTypeName];return e.flags.hasReferencedOpenAiAnyType=!0,{$ref:"relative"===e.$refStrategy?eG(t,e.currentPath):t.join("/")}}function rK(e,t){return ai(e.type._def,t)}e.s(["BRAND",0,rr,"NEVER",0,tr,"Schema",()=>tp,"ZodAny",()=>tU,"ZodArray",()=>tz,"ZodBigInt",()=>tj,"ZodBoolean",()=>tZ,"ZodBranded",()=>ra,"ZodCatch",()=>re,"ZodDate",()=>tP,"ZodDefault",()=>t8,"ZodDiscriminatedUnion",()=>tJ,"ZodEffects",()=>t5,"ZodEnum",()=>t9,"ZodFirstPartyTypeKind",()=>_,"ZodFunction",()=>tX,"ZodIntersection",()=>tW,"ZodLazy",()=>t0,"ZodLiteral",()=>t1,"ZodMap",()=>tQ,"ZodNaN",()=>rt,"ZodNativeEnum",()=>t4,"ZodNever",()=>tF,"ZodNull",()=>tD,"ZodNullable",()=>t7,"ZodNumber",()=>tO,"ZodObject",()=>tB,"ZodOptional",()=>t3,"ZodPipeline",()=>rs,"ZodPromise",()=>t6,"ZodReadonly",()=>rn,"ZodRecord",()=>tY,"ZodSchema",()=>tp,"ZodSet",()=>tG,"ZodString",()=>tR,"ZodSymbol",()=>tM,"ZodTransformer",()=>t5,"ZodTuple",()=>tK,"ZodType",()=>tp,"ZodUndefined",()=>t$,"ZodUnion",()=>tV,"ZodUnknown",()=>tq,"ZodVoid",()=>tL,"any",()=>r_,"array",()=>rk,"bigint",()=>rm,"boolean",()=>rh,"coerce",0,rJ,"custom",()=>ro,"date",()=>rf,"datetimeRegex",()=>tN,"discriminatedUnion",()=>rI,"effect",()=>rU,"enum",()=>rM,"function",()=>rj,"instanceof",()=>ru,"intersection",()=>rC,"late",0,rl,"lazy",()=>rZ,"literal",()=>rP,"map",()=>rR,"nan",()=>rp,"nativeEnum",()=>r$,"never",()=>rw,"null",()=>rv,"nullable",()=>rF,"number",()=>rd,"object",()=>rT,"oboolean",()=>rH,"onumber",()=>rV,"optional",()=>rq,"ostring",()=>rB,"pipeline",()=>rz,"preprocess",()=>rL,"promise",()=>rD,"record",()=>rN,"set",()=>rO,"strictObject",()=>rS,"string",()=>rc,"symbol",()=>ry,"transformer",()=>rU,"tuple",()=>rE,"undefined",()=>rg,"union",()=>rA,"unknown",()=>rb,"void",()=>rx],62404);let rY=/^[cC][^\s-]{8,}$/,rQ=/^[0-9a-z]+$/,rG=/^[0-9A-HJKMNP-TV-Z]{26}$/,rX=/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,r0=()=>(void 0===r&&(r=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),r),r1=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,r2=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,r9=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,r4=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,r6=/^[a-zA-Z0-9_-]{21}$/,r5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/;function r3(e,t){let r={type:"string"};if(e.checks)for(let a of e.checks)switch(a.kind){case"min":eQ(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,a.message,t);break;case"max":eQ(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":ae(r,"email",a.message,t);break;case"format:idn-email":ae(r,"idn-email",a.message,t);break;case"pattern:zod":at(r,rX,a.message,t)}break;case"url":ae(r,"uri",a.message,t);break;case"uuid":ae(r,"uuid",a.message,t);break;case"regex":at(r,a.regex,a.message,t);break;case"cuid":at(r,rY,a.message,t);break;case"cuid2":at(r,rQ,a.message,t);break;case"startsWith":at(r,RegExp(`^${r7(a.value,t)}`),a.message,t);break;case"endsWith":at(r,RegExp(`${r7(a.value,t)}$`),a.message,t);break;case"datetime":ae(r,"date-time",a.message,t);break;case"date":ae(r,"date",a.message,t);break;case"time":ae(r,"time",a.message,t);break;case"duration":ae(r,"duration",a.message,t);break;case"length":eQ(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,a.message,t),eQ(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value,a.message,t);break;case"includes":at(r,RegExp(r7(a.value,t)),a.message,t);break;case"ip":"v6"!==a.version&&ae(r,"ipv4",a.message,t),"v4"!==a.version&&ae(r,"ipv6",a.message,t);break;case"base64url":at(r,r4,a.message,t);break;case"jwt":at(r,r5,a.message,t);break;case"cidr":"v6"!==a.version&&at(r,r1,a.message,t),"v4"!==a.version&&at(r,r2,a.message,t);break;case"emoji":at(r,r0(),a.message,t);break;case"ulid":at(r,rG,a.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":ae(r,"binary",a.message,t);break;case"contentEncoding:base64":eQ(r,"contentEncoding","base64",a.message,t);break;case"pattern:zod":at(r,r9,a.message,t)}break;case"nanoid":at(r,r6,a.message,t)}return r}function r7(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let r=0;r<e.length;r++)r8.has(e[r])||(t+="\\"),t+=e[r];return t}(e):e}let r8=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function ae(e,t,r,a){e.format||e.anyOf?.some(e=>e.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&a.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push({format:t,...r&&a.errorMessages&&{errorMessage:{format:r}}})):eQ(e,"format",t,r,a)}function at(e,t,r,a){e.pattern||e.allOf?.some(e=>e.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&a.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push({pattern:ar(t,a),...r&&a.errorMessages&&{errorMessage:{pattern:r}}})):eQ(e,"pattern",ar(t,a),r,a)}function ar(e,t){if(!t.applyRegexFlags||!e.flags)return e.source;let r={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},a=r.i?e.source.toLowerCase():e.source,s="",n=!1,i=!1,o=!1;for(let e=0;e<a.length;e++){if(n){s+=a[e],n=!1;continue}if(r.i){if(i){if(a[e].match(/[a-z]/)){o?(s+=a[e],s+=`${a[e-2]}-${a[e]}`.toUpperCase(),o=!1):"-"===a[e+1]&&a[e+2]?.match(/[a-z]/)?(s+=a[e],o=!0):s+=`${a[e]}${a[e].toUpperCase()}`;continue}}else if(a[e].match(/[a-z]/)){s+=`[${a[e]}${a[e].toUpperCase()}]`;continue}}if(r.m){if("^"===a[e]){s+=`(^|(?<=[\r
]))`;continue}else if("$"===a[e]){s+=`($|(?=[\r
]))`;continue}}if(r.s&&"."===a[e]){s+=i?`${a[e]}\r
`:`[${a[e]}\r
]`;continue}s+=a[e],"\\"===a[e]?n=!0:i&&"]"===a[e]?i=!1:i||"["!==a[e]||(i=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function aa(e,t){if("openAi"===t.target&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),"openApi3"===t.target&&e.keyType?._def.typeName===_.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((r,a)=>({...r,[a]:ai(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",a]})??rW(t)}),{}),additionalProperties:t.rejectedAdditionalProperties};let r={type:"object",additionalProperties:ai(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if("openApi3"===t.target)return r;if(e.keyType?._def.typeName===_.ZodString&&e.keyType._def.checks?.length){let{type:a,...s}=r3(e.keyType._def,t);return{...r,propertyNames:s}}if(e.keyType?._def.typeName===_.ZodEnum)return{...r,propertyNames:{enum:e.keyType._def.values}};if(e.keyType?._def.typeName===_.ZodBranded&&e.keyType._def.type._def.typeName===_.ZodString&&e.keyType._def.type._def.checks?.length){let{type:a,...s}=rK(e.keyType._def,t);return{...r,propertyNames:s}}return r}let as={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},an=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>ai(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0};function ai(e,t,r=!1){let a=t.seen.get(e);if(t.override){let s=t.override?.(e,t,a,r);if(s!==eW)return s}if(a&&!r){let e=ao(a,t);if(void 0!==e)return e}let s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);let n=((e,t,r)=>{switch(t){case _.ZodString:return r3(e,r);case _.ZodNumber:let a={type:"number"};if(!e.checks)return a;for(let t of e.checks)switch(t.kind){case"int":a.type="integer",eY(a,"type",t.message,r);break;case"min":"jsonSchema7"===r.target?t.inclusive?eQ(a,"minimum",t.value,t.message,r):eQ(a,"exclusiveMinimum",t.value,t.message,r):(t.inclusive||(a.exclusiveMinimum=!0),eQ(a,"minimum",t.value,t.message,r));break;case"max":"jsonSchema7"===r.target?t.inclusive?eQ(a,"maximum",t.value,t.message,r):eQ(a,"exclusiveMaximum",t.value,t.message,r):(t.inclusive||(a.exclusiveMaximum=!0),eQ(a,"maximum",t.value,t.message,r));break;case"multipleOf":eQ(a,"multipleOf",t.value,t.message,r)}return a;case _.ZodObject:return function(e,t){let r="openAi"===t.target,a={type:"object",properties:{}},s=[],n=e.shape();for(let e in n){let i=n[e];if(void 0===i||void 0===i._def)continue;let o=function(e){try{return e.isOptional()}catch{return!0}}(i);o&&r&&("ZodOptional"===i._def.typeName&&(i=i._def.innerType),i.isNullable()||(i=i.nullable()),o=!1);let l=ai(i._def,{...t,currentPath:[...t.currentPath,"properties",e],propertyPath:[...t.currentPath,"properties",e]});void 0!==l&&(a.properties[e]=l,o||s.push(e))}s.length&&(a.required=s);let i=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return ai(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==i&&(a.additionalProperties=i),a}(e,r);case _.ZodBigInt:let s={type:"integer",format:"int64"};if(!e.checks)return s;for(let t of e.checks)switch(t.kind){case"min":"jsonSchema7"===r.target?t.inclusive?eQ(s,"minimum",t.value,t.message,r):eQ(s,"exclusiveMinimum",t.value,t.message,r):(t.inclusive||(s.exclusiveMinimum=!0),eQ(s,"minimum",t.value,t.message,r));break;case"max":"jsonSchema7"===r.target?t.inclusive?eQ(s,"maximum",t.value,t.message,r):eQ(s,"exclusiveMaximum",t.value,t.message,r):(t.inclusive||(s.exclusiveMaximum=!0),eQ(s,"maximum",t.value,t.message,r));break;case"multipleOf":eQ(s,"multipleOf",t.value,t.message,r)}return s;case _.ZodBoolean:return{type:"boolean"};case _.ZodDate:return function e(t,r,a){let s=a??r.dateStrategy;if(Array.isArray(s))return{anyOf:s.map((a,s)=>e(t,r,a))};switch(s){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":var n=t,i=r;let o={type:"integer",format:"unix-time"};if("openApi3"===i.target)return o;for(let e of n.checks)switch(e.kind){case"min":eQ(o,"minimum",e.value,e.message,i);break;case"max":eQ(o,"maximum",e.value,e.message,i)}return o}}(e,r);case _.ZodUndefined:return{not:rW(r)};case _.ZodNull:return"openApi3"===r.target?{enum:["null"],nullable:!0}:{type:"null"};case _.ZodArray:let n;return n={type:"array"},e.type?._def&&e.type?._def?.typeName!==_.ZodAny&&(n.items=ai(e.type._def,{...r,currentPath:[...r.currentPath,"items"]})),e.minLength&&eQ(n,"minItems",e.minLength.value,e.minLength.message,r),e.maxLength&&eQ(n,"maxItems",e.maxLength.value,e.maxLength.message,r),e.exactLength&&(eQ(n,"minItems",e.exactLength.value,e.exactLength.message,r),eQ(n,"maxItems",e.exactLength.value,e.exactLength.message,r)),n;case _.ZodUnion:case _.ZodDiscriminatedUnion:if("openApi3"===r.target)return an(e,r);let i=e.options instanceof Map?Array.from(e.options.values()):e.options;if(i.every(e=>e._def.typeName in as&&(!e._def.checks||!e._def.checks.length))){let e=i.reduce((e,t)=>{let r=as[t._def.typeName];return r&&!e.includes(r)?[...e,r]:e},[]);return{type:e.length>1?e:e[0]}}if(i.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=i.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===i.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:i.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(i.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:i.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return an(e,r);case _.ZodIntersection:let o,l,u;return o=[ai(e.left._def,{...r,currentPath:[...r.currentPath,"allOf","0"]}),ai(e.right._def,{...r,currentPath:[...r.currentPath,"allOf","1"]})].filter(e=>!!e),l="jsonSchema2019-09"===r.target?{unevaluatedProperties:!1}:void 0,u=[],o.forEach(e=>{if((!("type"in e)||"string"!==e.type)&&"allOf"in e)u.push(...e.allOf),void 0===e.unevaluatedProperties&&(l=void 0);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:r,...a}=e;t=a}else l=void 0;u.push(t)}}),u.length?{allOf:u,...l}:void 0;case _.ZodTuple:return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,t)=>ai(e._def,{...r,currentPath:[...r.currentPath,"items",`${t}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:ai(e.rest._def,{...r,currentPath:[...r.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,t)=>ai(e._def,{...r,currentPath:[...r.currentPath,"items",`${t}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])};case _.ZodRecord:return aa(e,r);case _.ZodLiteral:let c;return"bigint"!=(c=typeof e.value)&&"number"!==c&&"boolean"!==c&&"string"!==c?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===r.target?{type:"bigint"===c?"integer":c,enum:[e.value]}:{type:"bigint"===c?"integer":c,const:e.value};case _.ZodEnum:return{type:"string",enum:Array.from(e.values)};case _.ZodNativeEnum:let d,p,m;return d=e.values,{type:1===(m=Array.from(new Set((p=Object.keys(e.values).filter(e=>"number"!=typeof d[d[e]]).map(e=>d[e])).map(e=>typeof e)))).length?"string"===m[0]?"string":"number":["string","number"],enum:p};case _.ZodNullable:if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===r.target?{type:as[e.innerType._def.typeName],nullable:!0}:{type:[as[e.innerType._def.typeName],"null"]};if("openApi3"===r.target){let t=ai(e.innerType._def,{...r,currentPath:[...r.currentPath]});return t&&"$ref"in t?{allOf:[t],nullable:!0}:t&&{...t,nullable:!0}}let h=ai(e.innerType._def,{...r,currentPath:[...r.currentPath,"anyOf","0"]});return h&&{anyOf:[h,{type:"null"}]};case _.ZodOptional:if(r.currentPath.toString()===r.propertyPath?.toString())return ai(e.innerType._def,r);let f=ai(e.innerType._def,{...r,currentPath:[...r.currentPath,"anyOf","1"]});return f?{anyOf:[{not:rW(r)},f]}:rW(r);case _.ZodMap:if("record"===r.mapStrategy)return aa(e,r);return{type:"array",maxItems:125,items:{type:"array",items:[ai(e.keyType._def,{...r,currentPath:[...r.currentPath,"items","items","0"]})||rW(r),ai(e.valueType._def,{...r,currentPath:[...r.currentPath,"items","items","1"]})||rW(r)],minItems:2,maxItems:2}};case _.ZodSet:let y;return y={type:"array",uniqueItems:!0,items:ai(e.valueType._def,{...r,currentPath:[...r.currentPath,"items"]})},e.minSize&&eQ(y,"minItems",e.minSize.value,e.minSize.message,r),e.maxSize&&eQ(y,"maxItems",e.maxSize.value,e.maxSize.message,r),y;case _.ZodLazy:return()=>e.getter()._def;case _.ZodPromise:return ai(e.type._def,r);case _.ZodNaN:case _.ZodNever:return"openAi"===r.target?void 0:{not:rW({...r,currentPath:[...r.currentPath,"not"]})};case _.ZodEffects:return"input"===r.effectStrategy?ai(e.schema._def,r):rW(r);case _.ZodAny:case _.ZodUnknown:return rW(r);case _.ZodDefault:return{...ai(e.innerType._def,r),default:e.defaultValue()};case _.ZodBranded:return rK(e,r);case _.ZodReadonly:case _.ZodCatch:return ai(e.innerType._def,r);case _.ZodPipeline:if("input"===r.pipeStrategy)return ai(e.in._def,r);if("output"===r.pipeStrategy)return ai(e.out._def,r);let g=ai(e.in._def,{...r,currentPath:[...r.currentPath,"allOf","0"]}),v=ai(e.out._def,{...r,currentPath:[...r.currentPath,"allOf",g?"1":"0"]});return{allOf:[g,v].filter(e=>void 0!==e)};case _.ZodFunction:case _.ZodVoid:case _.ZodSymbol:default:return}})(e,e.typeName,t),i="function"==typeof n?ai(n(),t):n;if(i&&al(e,t,i),t.postProcess){let r=t.postProcess(i,e,t);return s.jsonSchema=i,r}return s.jsonSchema=i,i}let ao=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:eG(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),rW(t);return"seen"===t.$refStrategy?rW(t):void 0}},al=(e,t,r)=>(e.description&&(r.description=e.description,t.markdownDescription&&(r.markdownDescription=e.description)),r);var au={code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw Error('"text" parts expect a string value.');return{type:"text",value:e}}},ac={code:"1",name:"function_call",parse:e=>{if(null==e||"object"!=typeof e||!("function_call"in e)||"object"!=typeof e.function_call||null==e.function_call||!("name"in e.function_call)||!("arguments"in e.function_call)||"string"!=typeof e.function_call.name||"string"!=typeof e.function_call.arguments)throw Error('"function_call" parts expect an object with a "function_call" property.');return{type:"function_call",value:e}}},ad={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw Error('"data" parts expect an array value.');return{type:"data",value:e}}},ap={code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw Error('"error" parts expect a string value.');return{type:"error",value:e}}},am={code:"4",name:"assistant_message",parse:e=>{if(null==e||"object"!=typeof e||!("id"in e)||!("role"in e)||!("content"in e)||"string"!=typeof e.id||"string"!=typeof e.role||"assistant"!==e.role||!Array.isArray(e.content)||!e.content.every(e=>null!=e&&"object"==typeof e&&"type"in e&&"text"===e.type&&"text"in e&&null!=e.text&&"object"==typeof e.text&&"value"in e.text&&"string"==typeof e.text.value))throw Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},ah={code:"5",name:"assistant_control_data",parse:e=>{if(null==e||"object"!=typeof e||!("threadId"in e)||!("messageId"in e)||"string"!=typeof e.threadId||"string"!=typeof e.messageId)throw Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},af={code:"6",name:"data_message",parse:e=>{if(null==e||"object"!=typeof e||!("role"in e)||!("data"in e)||"string"!=typeof e.role||"data"!==e.role)throw Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},ay={code:"7",name:"tool_calls",parse:e=>{if(null==e||"object"!=typeof e||!("tool_calls"in e)||"object"!=typeof e.tool_calls||null==e.tool_calls||!Array.isArray(e.tool_calls)||e.tool_calls.some(e=>null==e||"object"!=typeof e||!("id"in e)||"string"!=typeof e.id||!("type"in e)||"string"!=typeof e.type||!("function"in e)||null==e.function||"object"!=typeof e.function||!("arguments"in e.function)||"string"!=typeof e.function.name||"string"!=typeof e.function.arguments))throw Error('"tool_calls" parts expect an object with a ToolCallPayload.');return{type:"tool_calls",value:e}}},ag={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},av={code:"9",name:"tool_call",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName||!("args"in e)||"object"!=typeof e.args)throw Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},a_={code:"a",name:"tool_result",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("result"in e))throw Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},ab={code:"b",name:"tool_call_streaming_start",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName)throw Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},aw={code:"c",name:"tool_call_delta",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("argsTextDelta"in e)||"string"!=typeof e.argsTextDelta)throw Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},ax={code:"d",name:"finish_message",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_message" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:NaN}),{type:"finish_message",value:t}}},ak={code:"e",name:"finish_step",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_step" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:NaN}),"isContinued"in e&&"boolean"==typeof e.isContinued&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},aT=[au,ac,ad,ap,am,ah,af,ay,ag,av,a_,ab,aw,ax,ak];function aS(e,t){let r=aT.find(t=>t.name===e);if(!r)throw Error(`Invalid stream part type: ${e}`);return`${r.code}:${JSON.stringify(t)}
`}au.code,ac.code,ad.code,ap.code,am.code,ah.code,af.code,ay.code,ag.code,av.code,a_.code,ab.code,aw.code,ax.code,ak.code,au.name,au.code,ac.name,ac.code,ad.name,ad.code,ap.name,ap.code,am.name,am.code,ah.name,ah.code,af.name,af.code,ay.name,ay.code,ag.name,ag.code,av.name,av.code,a_.name,a_.code,ab.name,ab.code,aw.name,aw.code,ax.name,ax.code,ak.name,ak.code,aT.map(e=>e.code);var aA=Symbol.for("vercel.ai.schema");function aI(e){var t;return"object"==typeof e&&null!==e&&aA in e&&!0===e[aA]&&"jsonSchema"in e&&"validate"in e?e:function(e,{validate:t}={}){return{[aA]:!0,_type:void 0,[eU]:!0,jsonSchema:e,validate:t}}(((e,t)=>{let r,a,s=(a=void 0!==(r="string"==typeof t?{...eK,name:t}:{...eK,...t}).name?[...r.basePath,r.definitionPath,r.name]:r.basePath,{...r,flags:{hasReferencedOpenAiAnyType:!1},currentPath:a,propertyPath:void 0,seen:new Map(Object.entries(r.definitions).map(([e,t])=>[t._def,{def:t._def,path:[...r.basePath,r.definitionPath,e],jsonSchema:void 0}]))}),n="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,[t,r])=>({...e,[t]:ai(r._def,{...s,currentPath:[...s.basePath,s.definitionPath,t]},!0)??rW(s)}),{}):void 0,i="string"==typeof t?t:t?.nameStrategy==="title"?void 0:t?.name,o=ai(e._def,void 0===i?s:{...s,currentPath:[...s.basePath,s.definitionPath,i]},!1)??rW(s),l="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==l&&(o.title=l),s.flags.hasReferencedOpenAiAnyType&&(n||(n={}),n[s.openAiAnyTypeName]||(n[s.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:"relative"===s.$refStrategy?"1":[...s.basePath,s.definitionPath,s.openAiAnyTypeName].join("/")}}));let u=void 0===i?n?{...o,[s.definitionPath]:n}:o:{$ref:[..."relative"===s.$refStrategy?[]:s.basePath,s.definitionPath,i].join("/"),[s.definitionPath]:{...n,[i]:o}};return"jsonSchema7"===s.target?u.$schema="http://json-schema.org/draft-07/schema#":("jsonSchema2019-09"===s.target||"openAi"===s.target)&&(u.$schema="https://json-schema.org/draft/2019-09/schema#"),"openAi"===s.target&&("anyOf"in u||"oneOf"in u||"allOf"in u||"type"in u&&Array.isArray(u.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),u})(t=e),{validate:e=>{let r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}})}var aC=e.i(26644),aE=e.i(84316);e.s([],80806),e.i(80806),e.i(52610),e.s(["defaultErrorMap",0,e4,"getErrorMap",()=>e3,"setErrorMap",()=>e5],19023),e.i(19023),e.i(3955),e.s([],96699),e.i(96699),e.i(53557),e.i(62404),e.i(66502),e.s(["BRAND",0,rr,"DIRTY",0,ta,"EMPTY_PATH",0,e8,"INVALID",0,tr,"NEVER",0,tr,"OK",0,ts,"ParseStatus",()=>tt,"Schema",()=>tp,"ZodAny",()=>tU,"ZodArray",()=>tz,"ZodBigInt",()=>tj,"ZodBoolean",()=>tZ,"ZodBranded",()=>ra,"ZodCatch",()=>re,"ZodDate",()=>tP,"ZodDefault",()=>t8,"ZodDiscriminatedUnion",()=>tJ,"ZodEffects",()=>t5,"ZodEnum",()=>t9,"ZodError",()=>e9,"ZodFirstPartyTypeKind",()=>_,"ZodFunction",()=>tX,"ZodIntersection",()=>tW,"ZodIssueCode",0,e1,"ZodLazy",()=>t0,"ZodLiteral",()=>t1,"ZodMap",()=>tQ,"ZodNaN",()=>rt,"ZodNativeEnum",()=>t4,"ZodNever",()=>tF,"ZodNull",()=>tD,"ZodNullable",()=>t7,"ZodNumber",()=>tO,"ZodObject",()=>tB,"ZodOptional",()=>t3,"ZodParsedType",0,eX,"ZodPipeline",()=>rs,"ZodPromise",()=>t6,"ZodReadonly",()=>rn,"ZodRecord",()=>tY,"ZodSchema",()=>tp,"ZodSet",()=>tG,"ZodString",()=>tR,"ZodSymbol",()=>tM,"ZodTransformer",()=>t5,"ZodTuple",()=>tK,"ZodType",()=>tp,"ZodUndefined",()=>t$,"ZodUnion",()=>tV,"ZodUnknown",()=>tq,"ZodVoid",()=>tL,"addIssueToContext",()=>te,"any",()=>r_,"array",()=>rk,"bigint",()=>rm,"boolean",()=>rh,"coerce",0,rJ,"custom",()=>ro,"date",()=>rf,"datetimeRegex",()=>tN,"defaultErrorMap",0,e4,"discriminatedUnion",()=>rI,"effect",()=>rU,"enum",()=>rM,"function",()=>rj,"getErrorMap",()=>e3,"getParsedType",0,e0,"instanceof",()=>ru,"intersection",()=>rC,"isAborted",0,tn,"isAsync",0,tl,"isDirty",0,ti,"isValid",0,to,"late",0,rl,"lazy",()=>rZ,"literal",()=>rP,"makeIssue",0,e7,"map",()=>rR,"nan",()=>rp,"nativeEnum",()=>r$,"never",()=>rw,"null",()=>rv,"nullable",()=>rF,"number",()=>rd,"object",()=>rT,"objectUtil",()=>g,"oboolean",()=>rH,"onumber",()=>rV,"optional",()=>rq,"ostring",()=>rB,"pipeline",()=>rz,"preprocess",()=>rL,"promise",()=>rD,"quotelessJson",0,e2,"record",()=>rN,"set",()=>rO,"setErrorMap",()=>e5,"strictObject",()=>rS,"string",()=>rc,"symbol",()=>ry,"transformer",()=>rU,"tuple",()=>rE,"undefined",()=>rg,"union",()=>rA,"unknown",()=>rb,"util",()=>y,"void",()=>rx],66253);var aN=e.i(66253),aN=aN,aR=Object.defineProperty,aO=(e,t)=>{for(var r in t)aR(e,r,{get:t[r],enumerable:!0})};async function aj(e){return void 0===e?Promise.resolve():new Promise(t=>setTimeout(t,e))}var aZ="AI_RetryError",aP=`vercel.ai.error.${aZ}`,aM=Symbol.for(aP),a$=class extends W{constructor({message:e,reason:t,errors:r}){super({name:aZ,message:e}),this[b]=!0,this.reason=t,this.errors=r,this.lastError=r[r.length-1]}static isInstance(e){return W.hasMarker(e,aP)}static isRetryError(e){return e instanceof Error&&e.name===aZ&&"string"==typeof e.reason&&Array.isArray(e.errors)}toJSON(){return{name:this.name,message:this.message,reason:this.reason,lastError:this.lastError,errors:this.errors}}};async function aD(e,{maxRetries:t,delayInMs:r,backoffFactor:a},s=[]){try{return await e()}catch(l){if(eD(l)||0===t)throw l;let n=null==l?"unknown error":"string"==typeof l?l:l instanceof Error?l.message:JSON.stringify(l),i=[...s,l],o=i.length;if(o>t)throw new a$({message:`Failed after ${o} attempts. Last error: ${n}`,reason:"maxRetriesExceeded",errors:i});if(l instanceof Error&&G.isAPICallError(l)&&!0===l.isRetryable&&o<=t)return await aj(r),aD(e,{maxRetries:t,delayInMs:a*r,backoffFactor:a},i);if(1===o)throw l;throw new a$({message:`Failed after ${o} attempts with non-retryable error: '${n}'`,reason:"errorNotRetryable",errors:i})}}function aU({operationId:e,telemetry:t}){return{"operation.name":`${e}${(null==t?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":null==t?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":null==t?void 0:t.functionId}}b=aM;var aq={startSpan:()=>aF,startActiveSpan:(e,t,r,a)=>"function"==typeof t?t(aF):"function"==typeof r?r(aF):"function"==typeof a?a(aF):void 0},aF={spanContext:()=>aL,setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording:()=>!1,recordException(){return this}},aL={traceId:"",spanId:"",traceFlags:0};function az({name:e,tracer:t,attributes:r,fn:a,endWhenDone:s=!0}){return t.startActiveSpan(e,{attributes:r},async e=>{try{let t=await a(e);return s&&e.end(),t}catch(t){try{t instanceof Error?(e.recordException({name:t.name,message:t.message,stack:t.stack}),e.setStatus({code:aE.SpanStatusCode.ERROR,message:t.message})):e.setStatus({code:aE.SpanStatusCode.ERROR})}finally{e.end()}throw t}})}function aB({telemetry:e,attributes:t}){return(null==e?void 0:e.isEnabled)!==!0?{}:Object.entries(t).reduce((t,[r,a])=>{if(void 0===a)return t;if("object"==typeof a&&"input"in a&&"function"==typeof a.input){if((null==e?void 0:e.recordInputs)===!1)return t;let s=a.input();return void 0===s?t:{...t,[r]:s}}if("object"==typeof a&&"output"in a&&"function"==typeof a.output){if((null==e?void 0:e.recordOutputs)===!1)return t;let s=a.output();return void 0===s?t:{...t,[r]:s}}return{...t,[r]:a}},{})}var aV="AI_DownloadError",aH=`vercel.ai.error.${aV}`,aJ=Symbol.for(aH),aW=class extends W{constructor({url:e,statusCode:t,statusText:r,cause:a,message:s=null==a?`Failed to download ${e}: ${t} ${r}`:`Failed to download ${e}: ${a}`}){super({name:aV,message:s,cause:a}),this[w]=!0,this.url=e,this.statusCode=t,this.statusText=r}static isInstance(e){return W.hasMarker(e,aH)}static isDownloadError(e){return e instanceof Error&&e.name===aV&&"string"==typeof e.url&&(null==e.statusCode||"number"==typeof e.statusCode)&&(null==e.statusText||"string"==typeof e.statusText)}toJSON(){return{name:this.name,message:this.message,url:this.url,statusCode:this.statusCode,statusText:this.statusText,cause:this.cause}}};async function aK({url:e,fetchImplementation:t=fetch}){var r;let a=e.toString();try{let e=await t(a);if(!e.ok)throw new aW({url:a,statusCode:e.status,statusText:e.statusText});return{data:new Uint8Array(await e.arrayBuffer()),mimeType:null!=(r=e.headers.get("content-type"))?r:void 0}}catch(e){if(aW.isInstance(e))throw e;throw new aW({url:a,cause:e})}}w=aJ;var aY=[{mimeType:"image/gif",bytes:[71,73,70]},{mimeType:"image/png",bytes:[137,80,78,71]},{mimeType:"image/jpeg",bytes:[255,216]},{mimeType:"image/webp",bytes:[82,73,70,70]}],aQ="AI_InvalidDataContentError",aG=`vercel.ai.error.${aQ}`,aX=Symbol.for(aG),a0=class extends W{constructor({content:e,cause:t,message:r=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:aQ,message:r,cause:t}),this[x]=!0,this.content=e}static isInstance(e){return W.hasMarker(e,aG)}static isInvalidDataContentError(e){return e instanceof Error&&e.name===aQ&&null!=e.content}toJSON(){return{name:this.name,message:this.message,stack:this.stack,cause:this.cause,content:this.content}}};x=aX;var a1=aN.union([aN.string(),aN.instanceof(Uint8Array),aN.instanceof(ArrayBuffer),aN.custom(e=>{var t,r;return null!=(r=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&r},{message:"Must be a Buffer"})]);function a2(e){if(e instanceof Uint8Array)return e;if("string"==typeof e)try{let t;return t=eH(e.replace(/-/g,"+").replace(/_/g,"/")),Uint8Array.from(t,e=>e.codePointAt(0))}catch(t){throw new a0({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new a0({content:e})}var a9="AI_InvalidMessageRoleError",a4=`vercel.ai.error.${a9}`,a6=Symbol.for(a4),a5=class extends W{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:a9,message:t}),this[k]=!0,this.role=e}static isInstance(e){return W.hasMarker(e,a4)}static isInvalidMessageRoleError(e){return e instanceof Error&&e.name===a9&&"string"==typeof e.role}toJSON(){return{name:this.name,message:this.message,stack:this.stack,role:this.role}}};async function a3({prompt:e,modelSupportsImageUrls:t=!0,modelSupportsUrl:r=()=>!1,downloadImplementation:a=aK}){let s=await a7(e.messages,a,t,r);return[...null!=e.system?[{role:"system",content:e.system}]:[],...e.messages.map(e=>(function(e,t){let r=e.role;switch(r){case"system":return{role:"system",content:e.content,providerMetadata:e.experimental_providerMetadata};case"user":if("string"==typeof e.content)return{role:"user",content:[{type:"text",text:e.content}],providerMetadata:e.experimental_providerMetadata};return{role:"user",content:e.content.map(e=>(function(e,t){let r,a,s;if("text"===e.type)return{type:"text",text:e.text,providerMetadata:e.experimental_providerMetadata};let n=e.mimeType,i=e.type;switch(i){case"image":r=e.image;break;case"file":r=e.data;break;default:throw Error(`Unsupported part type: ${i}`)}try{a="string"==typeof r?new URL(r):r}catch(e){a=r}if(a instanceof URL)if("data:"===a.protocol){let{mimeType:e,base64Content:t}=function(e){try{let[t,r]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:r}}catch(e){return{mimeType:void 0,base64Content:void 0}}}(a.toString());if(null==e||null==t)throw Error(`Invalid data URL format in part ${i}`);n=e,s=a2(t)}else{let e=t[a.toString()];e?(s=e.data,null!=n||(n=e.mimeType)):s=a}else s=a2(a);switch(i){case"image":return null==n&&s instanceof Uint8Array&&(n=function(e){for(let{bytes:t,mimeType:r}of aY)if(e.length>=t.length&&t.every((t,r)=>e[r]===t))return r}(s)),{type:"image",image:s,mimeType:n,providerMetadata:e.experimental_providerMetadata};case"file":var o;if(null==n)throw Error("Mime type is missing for file part");return{type:"file",data:s instanceof Uint8Array?"string"==typeof(o=s)?o:o instanceof ArrayBuffer?eJ(new Uint8Array(o)):eJ(o):s,mimeType:n,providerMetadata:e.experimental_providerMetadata}}})(e,t)).filter(e=>"text"!==e.type||""!==e.text),providerMetadata:e.experimental_providerMetadata};case"assistant":if("string"==typeof e.content)return{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:e.experimental_providerMetadata};return{role:"assistant",content:e.content.filter(e=>"text"!==e.type||""!==e.text).map(e=>{let{experimental_providerMetadata:t,...r}=e;return{...r,providerMetadata:t}}),providerMetadata:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(e=>({type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,result:e.result,content:e.experimental_content,isError:e.isError,providerMetadata:e.experimental_providerMetadata})),providerMetadata:e.experimental_providerMetadata};default:throw new a5({role:r})}})(e,s))]}async function a7(e,t,r,a){let s=e.filter(e=>"user"===e.role).map(e=>e.content).filter(e=>Array.isArray(e)).flat().filter(e=>"image"===e.type||"file"===e.type).filter(e=>"image"!==e.type||!0!==r).map(e=>"image"===e.type?e.image:e.data).map(e=>"string"==typeof e&&(e.startsWith("http:")||e.startsWith("https:"))?new URL(e):e).filter(e=>e instanceof URL).filter(e=>!a(e));return Object.fromEntries((await Promise.all(s.map(async e=>({url:e,data:await t({url:e})})))).map(({url:e,data:t})=>[e.toString(),t]))}k=a6;var a8="AI_InvalidArgumentError",se=`vercel.ai.error.${a8}`,st=Symbol.for(se),sr=class extends W{constructor({parameter:e,value:t,message:r}){super({name:a8,message:`Invalid argument for parameter ${e}: ${r}`}),this[T]=!0,this.parameter=e,this.value=t}static isInstance(e){return W.hasMarker(e,se)}static isInvalidArgumentError(e){return e instanceof Error&&e.name===a8&&"string"==typeof e.parameter&&"string"==typeof e.value}toJSON(){return{name:this.name,message:this.message,stack:this.stack,parameter:this.parameter,value:this.value}}};T=st;var sa=aN.lazy(()=>aN.union([aN.null(),aN.string(),aN.number(),aN.boolean(),aN.record(aN.string(),sa),aN.array(sa)])),ss=aN.record(aN.string(),aN.record(aN.string(),sa)),sn=aN.array(aN.union([aN.object({type:aN.literal("text"),text:aN.string()}),aN.object({type:aN.literal("image"),data:aN.string(),mimeType:aN.string().optional()})])),si=aN.object({type:aN.literal("text"),text:aN.string(),experimental_providerMetadata:ss.optional()}),so=aN.object({type:aN.literal("image"),image:aN.union([a1,aN.instanceof(URL)]),mimeType:aN.string().optional(),experimental_providerMetadata:ss.optional()}),sl=aN.object({type:aN.literal("file"),data:aN.union([a1,aN.instanceof(URL)]),mimeType:aN.string(),experimental_providerMetadata:ss.optional()}),su=aN.object({type:aN.literal("tool-call"),toolCallId:aN.string(),toolName:aN.string(),args:aN.unknown()}),sc=aN.object({type:aN.literal("tool-result"),toolCallId:aN.string(),toolName:aN.string(),result:aN.unknown(),content:sn.optional(),isError:aN.boolean().optional(),experimental_providerMetadata:ss.optional()}),sd=aN.object({role:aN.literal("system"),content:aN.string(),experimental_providerMetadata:ss.optional()}),sp=aN.object({role:aN.literal("user"),content:aN.union([aN.string(),aN.array(aN.union([si,so,sl]))]),experimental_providerMetadata:ss.optional()}),sm=aN.object({role:aN.literal("assistant"),content:aN.union([aN.string(),aN.array(aN.union([si,su]))]),experimental_providerMetadata:ss.optional()}),sh=aN.object({role:aN.literal("tool"),content:aN.array(sc),experimental_providerMetadata:ss.optional()}),sf=aN.union([sd,sp,sm,sh]);function sy(e){return"object"==typeof e&&null!==e&&("function"===e.role||"data"===e.role||"toolInvocations"in e||"experimental_attachments"in e)?"has-ui-specific-parts":"object"==typeof e&&null!==e&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e)?"has-core-specific-parts":"object"==typeof e&&null!==e&&"role"in e&&"content"in e&&"string"==typeof e.content&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}var sg="AI_MessageConversionError",sv=`vercel.ai.error.${sg}`,s_=Symbol.for(sv),sb=class extends W{constructor({originalMessage:e,message:t}){super({name:sg,message:t}),this[S]=!0,this.originalMessage=e}static isInstance(e){return W.hasMarker(e,sv)}};function sw(e,{contentType:t,dataStreamVersion:r}){var a;let s=new Headers(null!=(a=null==e?void 0:e.headers)?a:{});return s.has("Content-Type")||s.set("Content-Type",t),void 0!==r&&s.set("X-Vercel-AI-Data-Stream",r),s}S=s_;Symbol.for("vercel.ai.error.AI_NoObjectGeneratedError");function sx(e,t){let r=e.pipeThrough(new TransformStream(t));return r[Symbol.asyncIterator]=()=>{let e=r.getReader();return{async next(){let{done:t,value:r}=await e.read();return t?{done:!0,value:void 0}:{done:!1,value:r}}}},r}function sk(){let e,t;return{promise:new Promise((r,a)=>{e=r,t=a}),resolve:e,reject:t}}function sT(){var e,t;return null!=(t=null==(e=null==globalThis?void 0:globalThis.performance)?void 0:e.now())?t:Date.now()}function sS(e,{contentType:t,dataStreamVersion:r}){let a={};if((null==e?void 0:e.headers)!=null)for(let[t,r]of Object.entries(e.headers))a[t]=r;return null==a["Content-Type"]&&(a["Content-Type"]=t),void 0!==r&&(a["X-Vercel-AI-Data-Stream"]=r),a}function sA({response:e,status:t,statusText:r,headers:a,stream:s}){e.writeHead(null!=t?t:200,r,a);let n=s.getReader();(async()=>{try{for(;;){let{done:t,value:r}=await n.read();if(t)break;e.write(r)}}catch(e){throw e}finally{e.end()}})()}eM({prefix:"aiobj",size:24}),eM({prefix:"aiobj",size:24});var sI="AI_InvalidToolArgumentsError",sC=`vercel.ai.error.${sI}`,sE=Symbol.for(sC),sN=class extends W{constructor({toolArgs:e,toolName:t,cause:r,message:a=`Invalid arguments for tool ${t}: ${ea(r)}`}){super({name:sI,message:a,cause:r}),this[A]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return W.hasMarker(e,sC)}static isInvalidToolArgumentsError(e){return e instanceof Error&&e.name===sI&&"string"==typeof e.toolName&&"string"==typeof e.toolArgs}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,toolName:this.toolName,toolArgs:this.toolArgs}}};A=sE;var sR="AI_NoSuchToolError",sO=`vercel.ai.error.${sR}`,sj=Symbol.for(sO),sZ=class extends W{constructor({toolName:e,availableTools:t,message:r=`Model tried to call unavailable tool '${e}'. ${void 0===t?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:sR,message:r}),this[I]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return W.hasMarker(e,sO)}static isNoSuchToolError(e){return e instanceof Error&&e.name===sR&&"toolName"in e&&void 0!=e.toolName&&"string"==typeof e.name}toJSON(){return{name:this.name,message:this.message,stack:this.stack,toolName:this.toolName,availableTools:this.availableTools}}};I=sj;var sP=/^([\s\S]*?)(\s+)(\S*)$/;function sM(e,t){let r,a,s=e.getReader(),n=t.getReader(),i=!1,o=!1;async function l(e){try{null==r&&(r=s.read());let t=await r;r=void 0,t.done?e.close():e.enqueue(t.value)}catch(t){e.error(t)}}async function u(e){try{null==a&&(a=n.read());let t=await a;a=void 0,t.done?e.close():e.enqueue(t.value)}catch(t){e.error(t)}}return new ReadableStream({async pull(e){try{if(i)return void await u(e);if(o)return void await l(e);null==r&&(r=s.read()),null==a&&(a=n.read());let{result:t,reader:c}=await Promise.race([r.then(e=>({result:e,reader:s})),a.then(e=>({result:e,reader:n}))]);t.done||e.enqueue(t.value),c===s?(r=void 0,t.done&&(await u(e),i=!0)):(a=void 0,t.done&&(o=!0,await l(e)))}catch(t){e.error(t)}},cancel(){s.cancel(),n.cancel()}})}eM({prefix:"aitxt",size:24});var s$=eM({prefix:"aitxt",size:24});async function sD({model:e,tools:t,toolChoice:r,system:a,prompt:s,messages:n,maxRetries:i,abortSignal:o,headers:l,maxToolRoundtrips:u=0,maxSteps:c=null!=u?u+1:1,experimental_continueSteps:d=!1,experimental_telemetry:p,experimental_providerMetadata:m,experimental_toolCallStreaming:h=!1,experimental_activeTools:f,onChunk:y,onFinish:g,onStepFinish:v,_internal:{now:_=sT,generateId:b=s$,currentDate:w=()=>new Date}={},...x}){if(c<1)throw new sr({parameter:"maxSteps",value:c,message:"maxSteps must be at least 1"});let k=function({model:e,settings:t,telemetry:r,headers:a}){var s;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((e,[t,r])=>(e[`ai.settings.${t}`]=r,e),{}),...Object.entries(null!=(s=null==r?void 0:r.metadata)?s:{}).reduce((e,[t,r])=>(e[`ai.telemetry.metadata.${t}`]=r,e),{}),...Object.entries(null!=a?a:{}).reduce((e,[t,r])=>(void 0!==r&&(e[`ai.request.headers.${t}`]=r),e),{})}}({model:e,telemetry:p,headers:l,settings:{...x,maxRetries:i}}),T=function({isEnabled:e=!1,tracer:t}={}){return e?t||aC.trace.getTracer("ai"):aq}(p),S=function({prompt:e,tools:t}){if(null==e.prompt&&null==e.messages)throw new ed({prompt:e,message:"prompt or messages must be defined"});if(null!=e.prompt&&null!=e.messages)throw new ed({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(null!=e.system&&"string"!=typeof e.system)throw new ed({prompt:e,message:"system must be a string"});if(null!=e.prompt){if("string"!=typeof e.prompt)throw new ed({prompt:e,message:"prompt must be a string"});return{type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(null!=e.messages){let r=function(e){if(!Array.isArray(e))return"other";if(0===e.length)return"messages";let t=e.map(sy);return t.some(e=>"has-ui-specific-parts"===e)?"ui-messages":t.every(e=>"has-core-specific-parts"===e||"message"===e)?"messages":"other"}(e.messages);if("other"===r)throw new ed({prompt:e,message:"messages must be an array of CoreMessage or UIMessage"});let a="ui-messages"===r?function(e,t){var r;let a=null!=(r=null==t?void 0:t.tools)?r:{},s=[];for(let t of e){let{role:e,content:r,toolInvocations:n,experimental_attachments:i}=t;switch(e){case"system":s.push({role:"system",content:r});break;case"user":s.push({role:"user",content:i?[{type:"text",text:r},...function(e){var t,r,a;let s=[];for(let n of e){let e;try{e=new URL(n.url)}catch(e){throw Error(`Invalid URL: ${n.url}`)}switch(e.protocol){case"http:":case"https:":if(null==(t=n.contentType)?void 0:t.startsWith("image/"))s.push({type:"image",image:e});else{if(!n.contentType)throw Error("If the attachment is not an image, it must specify a content type");s.push({type:"file",data:e,mimeType:n.contentType})}break;case"data:":{let e,t,i;try{[e,t]=n.url.split(","),i=e.split(";")[0].split(":")[1]}catch(e){throw Error(`Error processing data URL: ${n.url}`)}if(null==i||null==t)throw Error(`Invalid data URL format: ${n.url}`);if(null==(r=n.contentType)?void 0:r.startsWith("image/"))s.push({type:"image",image:a2(t)});else if(null==(a=n.contentType)?void 0:a.startsWith("text/"))s.push({type:"text",text:function(e){try{return new TextDecoder().decode(e)}catch(e){throw Error("Error decoding Uint8Array to text")}}(a2(t))});else{if(!n.contentType)throw Error("If the attachment is not an image or text, it must specify a content type");s.push({type:"file",data:t,mimeType:n.contentType})}break}default:throw Error(`Unsupported URL protocol: ${e.protocol}`)}}return s}(i)]:r});break;case"assistant":if(null==n){s.push({role:"assistant",content:r});break}s.push({role:"assistant",content:[{type:"text",text:r},...n.map(({toolCallId:e,toolName:t,args:r})=>({type:"tool-call",toolCallId:e,toolName:t,args:r}))]}),s.push({role:"tool",content:n.map(e=>{if(!("result"in e))throw new sb({originalMessage:t,message:"ToolInvocation must have a result: "+JSON.stringify(e)});let{toolCallId:r,toolName:s,result:n}=e,i=a[s];return(null==i?void 0:i.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:r,toolName:s,result:i.experimental_toToolResultContent(n),experimental_content:i.experimental_toToolResultContent(n)}:{type:"tool-result",toolCallId:r,toolName:s,result:n}})});break;case"function":case"data":case"tool":break;default:throw new sb({originalMessage:t,message:`Unsupported role: ${e}`})}}return s}(e.messages,{tools:t}):e.messages,s=eq({value:a,schema:aN.array(sf)});if(!s.success)throw new ed({prompt:e,message:"messages must be an array of CoreMessage or UIMessage",cause:s.error});return{type:"messages",messages:a,system:e.system}}throw Error("unreachable")}({prompt:{system:a,prompt:s,messages:n},tools:t});return az({name:"ai.streamText",attributes:aB({telemetry:p,attributes:{...aU({operationId:"ai.streamText",telemetry:p}),...k,"ai.prompt":{input:()=>JSON.stringify({system:a,prompt:s,messages:n})},"ai.settings.maxSteps":c}}),tracer:T,endWhenDone:!1,fn:async a=>{let s=(({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:r=2}={})=>async a=>aD(a,{maxRetries:e,delayInMs:t,backoffFactor:r}))({maxRetries:i}),n=async({responseMessages:a})=>{let n=0===a.length?S.type:"messages",i=await a3({prompt:{type:n,system:S.system,messages:[...S.messages,...a]},modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:e.supportsUrl}),u={type:"regular",...function({tools:e,toolChoice:t,activeTools:r}){return null!=e&&Object.keys(e).length>0?{tools:(null!=r?Object.entries(e).filter(([e])=>r.includes(e)):Object.entries(e)).map(([e,t])=>{let r=t.type;switch(r){case void 0:case"function":return{type:"function",name:e,description:t.description,parameters:aI(t.parameters).jsonSchema};case"provider-defined":return{type:"provider-defined",name:e,id:t.id,args:t.args};default:throw Error(`Unsupported tool type: ${r}`)}}),toolChoice:null==t?{type:"auto"}:"string"==typeof t?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}({tools:t,toolChoice:r,activeTools:f})},{result:{stream:c,warnings:d,rawResponse:y,request:g},doStreamSpan:v,startTimestampMs:b}=await s(()=>az({name:"ai.streamText.doStream",attributes:aB({telemetry:p,attributes:{...aU({operationId:"ai.streamText.doStream",telemetry:p}),...k,"ai.prompt.format":{input:()=>n},"ai.prompt.messages":{input:()=>JSON.stringify(i)},"ai.prompt.tools":{input:()=>{var e;return null==(e=u.tools)?void 0:e.map(e=>JSON.stringify(e))}},"ai.prompt.toolChoice":{input:()=>null!=u.toolChoice?JSON.stringify(u.toolChoice):void 0},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":x.frequencyPenalty,"gen_ai.request.max_tokens":x.maxTokens,"gen_ai.request.presence_penalty":x.presencePenalty,"gen_ai.request.stop_sequences":x.stopSequences,"gen_ai.request.temperature":x.temperature,"gen_ai.request.top_k":x.topK,"gen_ai.request.top_p":x.topP}}),tracer:T,endWhenDone:!1,fn:async t=>({startTimestampMs:_(),doStreamSpan:t,result:await e.doStream({mode:u,...function({maxTokens:e,temperature:t,topP:r,topK:a,presencePenalty:s,frequencyPenalty:n,stopSequences:i,seed:o,maxRetries:l}){if(null!=e){if(!Number.isInteger(e))throw new sr({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new sr({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(null!=t&&"number"!=typeof t)throw new sr({parameter:"temperature",value:t,message:"temperature must be a number"});if(null!=r&&"number"!=typeof r)throw new sr({parameter:"topP",value:r,message:"topP must be a number"});if(null!=a&&"number"!=typeof a)throw new sr({parameter:"topK",value:a,message:"topK must be a number"});if(null!=s&&"number"!=typeof s)throw new sr({parameter:"presencePenalty",value:s,message:"presencePenalty must be a number"});if(null!=n&&"number"!=typeof n)throw new sr({parameter:"frequencyPenalty",value:n,message:"frequencyPenalty must be a number"});if(null!=o&&!Number.isInteger(o))throw new sr({parameter:"seed",value:o,message:"seed must be an integer"});if(null!=l){if(!Number.isInteger(l))throw new sr({parameter:"maxRetries",value:l,message:"maxRetries must be an integer"});if(l<0)throw new sr({parameter:"maxRetries",value:l,message:"maxRetries must be >= 0"})}return{maxTokens:e,temperature:null!=t?t:0,topP:r,topK:a,presencePenalty:s,frequencyPenalty:n,stopSequences:null!=i&&i.length>0?i:void 0,seed:o,maxRetries:null!=l?l:2}}(x),inputFormat:n,prompt:i,providerMetadata:m,abortSignal:o,headers:l})})}));return{result:{stream:function({tools:e,generatorStream:t,toolCallStreaming:r,tracer:a,telemetry:s,abortSignal:n}){let i,o=null,l=new ReadableStream({start(e){o=e}}),u={},c=new Set,d=!1;function p(){d&&0===c.size&&(null!=i&&o.enqueue(i),o.close())}let m=new TransformStream({transform(t,l){let d=t.type;switch(d){case"text-delta":case"response-metadata":case"error":l.enqueue(t);break;case"tool-call-delta":r&&(u[t.toolCallId]||(l.enqueue({type:"tool-call-streaming-start",toolCallId:t.toolCallId,toolName:t.toolName}),u[t.toolCallId]=!0),l.enqueue({type:"tool-call-delta",toolCallId:t.toolCallId,toolName:t.toolName,argsTextDelta:t.argsTextDelta}));break;case"tool-call":{let r=t.toolName;if(null==e){o.enqueue({type:"error",error:new sZ({toolName:t.toolName})});break}let i=e[r];if(null==i){o.enqueue({type:"error",error:new sZ({toolName:t.toolName,availableTools:Object.keys(e)})});break}try{let r=function({toolCall:e,tools:t}){let r=e.toolName;if(null==t)throw new sZ({toolName:e.toolName});let a=t[r];if(null==a)throw new sZ({toolName:e.toolName,availableTools:Object.keys(t)});let s=aI(a.parameters),n=""===e.args.trim()?eq({value:{},schema:s}):eF({text:e.args,schema:s});if(!1===n.success)throw new sN({toolName:r,toolArgs:e.args,cause:n.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:r,args:n.value}}({toolCall:t,tools:e});if(l.enqueue(r),null!=i.execute){let e=e$();c.add(e),az({name:"ai.toolCall",attributes:aB({telemetry:s,attributes:{...aU({operationId:"ai.toolCall",telemetry:s}),"ai.toolCall.name":r.toolName,"ai.toolCall.id":r.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(r.args)}}}),tracer:a,fn:async t=>i.execute(r.args,{abortSignal:n}).then(a=>{o.enqueue({...r,type:"tool-result",result:a}),c.delete(e),p();try{t.setAttributes(aB({telemetry:s,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(a)}}}))}catch(e){}},t=>{o.enqueue({type:"error",error:t}),c.delete(e),p()})})}}catch(e){o.enqueue({type:"error",error:e})}break}case"finish":var m;i={type:"finish",finishReason:t.finishReason,logprobs:t.logprobs,usage:{promptTokens:(m=t.usage).promptTokens,completionTokens:m.completionTokens,totalTokens:m.promptTokens+m.completionTokens},experimental_providerMetadata:t.providerMetadata};break;default:throw Error(`Unhandled chunk type: ${d}`)}},flush(){d=!0,p()}});return new ReadableStream({start:async e=>Promise.all([t.pipeThrough(m).pipeTo(new WritableStream({write(t){e.enqueue(t)},close(){}})),l.pipeTo(new WritableStream({write(t){e.enqueue(t)},close(){e.close()}}))])})}({tools:t,generatorStream:c,toolCallStreaming:h,tracer:T,telemetry:p,abortSignal:o}),warnings:d,request:null!=g?g:{},rawResponse:y},doStreamSpan:v,startTimestampMs:b}},{result:{stream:u,warnings:A,rawResponse:I,request:C},doStreamSpan:E,startTimestampMs:N}=await n({responseMessages:[]});return new sU({stream:u,warnings:A,rawResponse:I,request:C,onChunk:y,onFinish:g,onStepFinish:v,rootSpan:a,doStreamSpan:E,telemetry:p,startTimestampMs:N,maxSteps:c,continueSteps:d,startStep:n,modelId:e.modelId,now:_,currentDate:w,generateId:b,tools:t})}})}var sU=class{constructor({stream:e,warnings:t,rawResponse:r,request:a,onChunk:s,onFinish:n,onStepFinish:i,rootSpan:o,doStreamSpan:l,telemetry:u,startTimestampMs:c,maxSteps:d,continueSteps:p,startStep:m,modelId:h,now:f,currentDate:y,generateId:g,tools:v}){this.warnings=t,this.rawResponse=r;const{resolve:_,promise:b}=sk();this.usage=b;const{resolve:w,promise:x}=sk();this.finishReason=x;const{resolve:k,promise:T}=sk();this.text=T;const{resolve:S,promise:A}=sk();this.toolCalls=A;const{resolve:I,promise:C}=sk();this.toolResults=C;const{resolve:E,promise:N}=sk();this.steps=N;const{resolve:R,promise:O}=sk();this.experimental_providerMetadata=O;const{resolve:j,promise:Z}=sk();this.request=Z;const{resolve:P,promise:M}=sk();this.response=M;const{resolve:$,promise:D}=sk();this.responseMessages=D;const{stream:U,addStream:q,close:F}=function(){let e=[],t=null,r=!1,a=async()=>{if(r&&0===e.length){null==t||t.close();return}if(0!==e.length)try{let{value:s,done:n}=await e[0].read();n?(e.shift(),e.length>0?await a():r&&(null==t||t.close())):null==t||t.enqueue(s)}catch(a){null==t||t.error(a),e.shift(),r&&0===e.length&&(null==t||t.close())}};return{stream:new ReadableStream({start(e){t=e},pull:a,async cancel(){for(let t of e)await t.cancel();e=[],r=!0}}),addStream:t=>{if(r)throw Error("Cannot add inner stream: outer stream is closed");e.push(t.getReader())},close:()=>{r=!0,0===e.length&&(null==t||t.close())}}}();this.originalStream=U;const L=[],z=this;!function e({stream:a,startTimestamp:l,doStreamSpan:c,currentStep:b,responseMessages:x,usage:T={promptTokens:0,completionTokens:0,totalTokens:0},stepType:A,previousStepText:C="",stepRequest:N,hasLeadingWhitespace:O}){let Z,M,D=[],U=[],B="unknown",V={promptTokens:0,completionTokens:0,totalTokens:0},H=!0,J="",W="continue"===A?C:"",K={id:g(),timestamp:y(),modelId:h},Y="",Q=!1,G=!0,X=!1;async function ee({controller:e,chunk:t}){e.enqueue(t),J+=t.textDelta,W+=t.textDelta,Q=!0,X=t.textDelta.trimEnd()!==t.textDelta,await (null==s?void 0:s({chunk:t}))}q(a.pipeThrough(new TransformStream({async transform(e,t){var r,a,n;if(H){let e=f()-l;H=!1,c.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":e,"ai.stream.msToFirstChunk":e}),c.setAttributes({"ai.response.msToFirstChunk":e,"ai.stream.msToFirstChunk":e})}if("text-delta"===e.type&&0===e.textDelta.length)return;let i=e.type;switch(i){case"text-delta":if(p){let r,a=G&&O?e.textDelta.trimStart():e.textDelta;if(0===a.length)break;G=!1,Y+=a;let s=(r=Y.match(sP))?{prefix:r[1],whitespace:r[2],suffix:r[3]}:void 0;null!=s&&(Y=s.suffix,await ee({controller:t,chunk:{type:"text-delta",textDelta:s.prefix+s.whitespace}}))}else await ee({controller:t,chunk:e});break;case"tool-call":t.enqueue(e),D.push(e),await (null==s?void 0:s({chunk:e}));break;case"tool-result":t.enqueue(e),U.push(e),await (null==s?void 0:s({chunk:e}));break;case"response-metadata":K={id:null!=(r=e.id)?r:K.id,timestamp:null!=(a=e.timestamp)?a:K.timestamp,modelId:null!=(n=e.modelId)?n:K.modelId};break;case"finish":{V=e.usage,B=e.finishReason,Z=e.experimental_providerMetadata,M=e.logprobs;let t=f()-l;c.addEvent("ai.stream.finish"),c.setAttributes({"ai.response.msToFinish":t,"ai.response.avgCompletionTokensPerSecond":1e3*V.completionTokens/t});break}case"tool-call-streaming-start":case"tool-call-delta":t.enqueue(e),await (null==s?void 0:s({chunk:e}));break;case"error":t.enqueue(e),B="error";break;default:throw Error(`Unknown chunk type: ${i}`)}},async flush(a){var s;let l=D.length>0?JSON.stringify(D):void 0,h="done";b+1<d&&(p&&"length"===B&&0===D.length?h="continue":D.length>0&&U.length===D.length&&(h="tool-result")),p&&Y.length>0&&("continue"!==h||"continue"===A&&!Q)&&(await ee({controller:a,chunk:{type:"text-delta",textDelta:Y}}),Y="");try{c.setAttributes(aB({telemetry:u,attributes:{"ai.response.finishReason":B,"ai.response.text":{output:()=>J},"ai.response.toolCalls":{output:()=>l},"ai.response.id":K.id,"ai.response.model":K.modelId,"ai.response.timestamp":K.timestamp.toISOString(),"ai.usage.promptTokens":V.promptTokens,"ai.usage.completionTokens":V.completionTokens,"ai.finishReason":B,"ai.result.text":{output:()=>J},"ai.result.toolCalls":{output:()=>l},"gen_ai.response.finish_reasons":[B],"gen_ai.response.id":K.id,"gen_ai.response.model":K.modelId,"gen_ai.usage.input_tokens":V.promptTokens,"gen_ai.usage.output_tokens":V.completionTokens}}))}catch(e){}finally{c.end()}if(a.enqueue({type:"step-finish",finishReason:B,usage:V,experimental_providerMetadata:Z,logprobs:M,response:{...K},isContinued:"continue"===h}),"continue"===A){let e=x[x.length-1];"string"==typeof e.content?e.content+=J:e.content.push({text:J,type:"text"})}else x.push(...function({text:e="",tools:t,toolCalls:r,toolResults:a}){let s=[];return s.push({role:"assistant",content:[{type:"text",text:e},...r]}),a.length>0&&s.push({role:"tool",content:a.map(e=>{let r=t[e.toolName];return(null==r?void 0:r.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,result:r.experimental_toToolResultContent(e.result),experimental_content:r.experimental_toToolResultContent(e.result)}:{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,result:e.result}})}),s}({text:J,tools:null!=v?v:{},toolCalls:D,toolResults:U}));let f={stepType:A,text:J,toolCalls:D,toolResults:U,finishReason:B,usage:V,warnings:z.warnings,logprobs:M,request:N,rawResponse:z.rawResponse,response:{...K,headers:null==(s=z.rawResponse)?void 0:s.headers,messages:JSON.parse(JSON.stringify(x))},experimental_providerMetadata:Z,isContinued:"continue"===h};L.push(f),await (null==i?void 0:i(f));let y={promptTokens:T.promptTokens+V.promptTokens,completionTokens:T.completionTokens+V.completionTokens,totalTokens:T.totalTokens+V.totalTokens};if("done"!==h){let{result:t,doStreamSpan:r,startTimestampMs:a}=await m({responseMessages:x});z.warnings=t.warnings,z.rawResponse=t.rawResponse,e({stream:t.stream,startTimestamp:a,doStreamSpan:r,currentStep:b+1,responseMessages:x,usage:y,stepType:h,previousStepText:W,stepRequest:t.request,hasLeadingWhitespace:X});return}try{a.enqueue({type:"finish",finishReason:B,usage:y,experimental_providerMetadata:Z,logprobs:M,response:{...K}}),F(),o.setAttributes(aB({telemetry:u,attributes:{"ai.response.finishReason":B,"ai.response.text":{output:()=>W},"ai.response.toolCalls":{output:()=>l},"ai.usage.promptTokens":y.promptTokens,"ai.usage.completionTokens":y.completionTokens,"ai.finishReason":B,"ai.result.text":{output:()=>W},"ai.result.toolCalls":{output:()=>l}}})),_(y),w(B),k(W),S(D),R(Z),I(U),j(N),P({...K,headers:null==r?void 0:r.headers,messages:x}),E(L),$(x),await (null==n?void 0:n({finishReason:B,logprobs:M,usage:y,text:W,toolCalls:D,toolResults:U,request:N,rawResponse:r,response:{...K,headers:null==r?void 0:r.headers,messages:x},warnings:t,experimental_providerMetadata:Z,steps:L,responseMessages:x}))}catch(e){a.error(e)}finally{o.end()}}})))}({stream:e,startTimestamp:c,doStreamSpan:l,currentStep:0,responseMessages:[],usage:void 0,stepType:"initial",stepRequest:a,hasLeadingWhitespace:!1})}teeStream(){let[e,t]=this.originalStream.tee();return this.originalStream=t,e}get textStream(){return sx(this.teeStream(),{transform(e,t){"text-delta"===e.type?t.enqueue(e.textDelta):"error"===e.type&&t.error(e.error)}})}get fullStream(){return sx(this.teeStream(),{transform(e,t){t.enqueue(e)}})}toAIStream(e={}){return this.toDataStreamInternal({callbacks:e})}toDataStreamInternal({callbacks:e={},getErrorMessage:t=()=>"",sendUsage:r=!0}={}){let a="",s=new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(t,r){if(r.enqueue(t),"text-delta"===t.type){let r=t.textDelta;a+=r,e.onToken&&await e.onToken(r),e.onText&&await e.onText(r)}},async flush(){e.onCompletion&&await e.onCompletion(a),e.onFinal&&await e.onFinal(a)}}),n=new TransformStream({transform:async(e,a)=>{let s=e.type;switch(s){case"text-delta":a.enqueue(aS("text",e.textDelta));break;case"tool-call-streaming-start":a.enqueue(aS("tool_call_streaming_start",{toolCallId:e.toolCallId,toolName:e.toolName}));break;case"tool-call-delta":a.enqueue(aS("tool_call_delta",{toolCallId:e.toolCallId,argsTextDelta:e.argsTextDelta}));break;case"tool-call":a.enqueue(aS("tool_call",{toolCallId:e.toolCallId,toolName:e.toolName,args:e.args}));break;case"tool-result":a.enqueue(aS("tool_result",{toolCallId:e.toolCallId,result:e.result}));break;case"error":a.enqueue(aS("error",t(e.error)));break;case"step-finish":a.enqueue(aS("finish_step",{finishReason:e.finishReason,usage:r?{promptTokens:e.usage.promptTokens,completionTokens:e.usage.completionTokens}:void 0,isContinued:e.isContinued}));break;case"finish":a.enqueue(aS("finish_message",{finishReason:e.finishReason,usage:r?{promptTokens:e.usage.promptTokens,completionTokens:e.usage.completionTokens}:void 0}));break;default:throw Error(`Unknown chunk type: ${s}`)}}});return this.fullStream.pipeThrough(s).pipeThrough(n).pipeThrough(new TextEncoderStream)}pipeAIStreamToResponse(e,t){return this.pipeDataStreamToResponse(e,t)}pipeDataStreamToResponse(e,t){let r=null==t?void 0:"init"in t?t.init:{headers:"headers"in t?t.headers:void 0,status:"status"in t?t.status:void 0,statusText:"statusText"in t?t.statusText:void 0},a=null==t?void 0:"data"in t?t.data:void 0,s=null==t?void 0:"getErrorMessage"in t?t.getErrorMessage:void 0,n=null==t?void 0:"sendUsage"in t?t.sendUsage:void 0;sA({response:e,status:null==r?void 0:r.status,statusText:null==r?void 0:r.statusText,headers:sS(r,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"}),stream:this.toDataStream({data:a,getErrorMessage:s,sendUsage:n})})}pipeTextStreamToResponse(e,t){sA({response:e,status:null==t?void 0:t.status,statusText:null==t?void 0:t.statusText,headers:sS(t,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)})}toAIStreamResponse(e){return this.toDataStreamResponse(e)}toDataStream(e){let t=this.toDataStreamInternal({getErrorMessage:null==e?void 0:e.getErrorMessage,sendUsage:null==e?void 0:e.sendUsage});return(null==e?void 0:e.data)?sM(null==e?void 0:e.data.stream,t):t}toDataStreamResponse(e){var t;let r=null==e?void 0:"init"in e?e.init:{headers:"headers"in e?e.headers:void 0,status:"status"in e?e.status:void 0,statusText:"statusText"in e?e.statusText:void 0},a=null==e?void 0:"data"in e?e.data:void 0,s=null==e?void 0:"getErrorMessage"in e?e.getErrorMessage:void 0,n=null==e?void 0:"sendUsage"in e?e.sendUsage:void 0;return new Response(this.toDataStream({data:a,getErrorMessage:s,sendUsage:n}),{status:null!=(t=null==r?void 0:r.status)?t:200,statusText:null==r?void 0:r.statusText,headers:sw(r,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:null!=(t=null==e?void 0:e.status)?t:200,headers:sw(e,{contentType:"text/plain; charset=utf-8"})})}};function sq(e){let t=new TextEncoder,r="",a=e||{};return new TransformStream({async start(){a.onStart&&await a.onStart()},async transform(e,s){let n="string"==typeof e?e:e.content;s.enqueue(t.encode(n)),r+=n,a.onToken&&await a.onToken(n),a.onText&&"string"==typeof e&&await a.onText(e)},async flush(){let e="experimental_onFunctionCall"in a;a.onCompletion&&await a.onCompletion(r),a.onFinal&&!e&&await a.onFinal(r)}})}function sF(){let e=new TextEncoder,t=new TextDecoder;return new TransformStream({transform:async(r,a)=>{let s=t.decode(r);a.enqueue(e.encode(aS("text",s)))}})}function sL(e,t){return sz(e,t)}function sz(e,t){return e.pipeThrough(new TransformStream({transform:async(e,t)=>{var r;if("string"==typeof e)return void t.enqueue(e);if("event"in e){"on_chat_model_stream"===e.event&&sV(null==(r=e.data)?void 0:r.chunk,t);return}sV(e,t)}})).pipeThrough(sq(t)).pipeThrough(sF())}function sB(e,t){var r;let a=sz(e,null==t?void 0:t.callbacks),s=null==t?void 0:t.data,n=null==t?void 0:t.init;return new Response(s?sM(s.stream,a):a,{status:null!=(r=null==n?void 0:n.status)?r:200,statusText:null==n?void 0:n.statusText,headers:sw(n,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function sV(e,t){if("string"==typeof e.content)t.enqueue(e.content);else for(let r of e.content)"text"===r.type&&t.enqueue(r.text)}function sH(e,t){let r,a,s;return(a=e[Symbol.asyncIterator](),s=(r=!0,e=>(r&&(e=e.trimStart())&&(r=!1),e)),new ReadableStream({async pull(e){var t;let{value:r,done:n}=await a.next();if(n)return void e.close();let i=s(null!=(t=r.delta)?t:"");i&&e.enqueue(i)}})).pipeThrough(sq(t)).pipeThrough(sF())}function sJ(e,t={}){var r;let{init:a,data:s,callbacks:n}=t,i=sH(e,n);return new Response(s?sM(s.stream,i):i,{status:null!=(r=null==a?void 0:a.status)?r:200,statusText:null==a?void 0:a.statusText,headers:sw(a,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}Symbol.for("vercel.ai.error.AI_NoSuchProviderError"),new TextDecoder("utf-8"),aO({},{toAIStream:()=>sL,toDataStream:()=>sz,toDataStreamResponse:()=>sB}),aO({},{toDataStream:()=>sH,toDataStreamResponse:()=>sJ}),Symbol("internal_openai_fn_messages"),Response;var aN=aN,sW=(({errorSchema:e,errorToMessage:t,isRetryable:r})=>async({response:a,url:s,requestBodyValues:n})=>{let i=await a.text(),o=eP(a);if(""===i.trim())return{responseHeaders:o,value:new G({message:a.statusText,url:s,requestBodyValues:n,statusCode:a.status,responseHeaders:o,responseBody:i,isRetryable:null==r?void 0:r(a)})};try{let l=function({text:e,schema:t}){try{let r=eO.default.parse(e);if(null==t)return r;return function({value:e,schema:t}){let r=eq({value:e,schema:t});if(!r.success)throw eI.wrap({value:e,cause:r.error});return r.value}({value:r,schema:t})}catch(t){if(ef.isJSONParseError(t)||eI.isTypeValidationError(t))throw t;throw new ef({text:e,cause:t})}}({text:i,schema:e});return{responseHeaders:o,value:new G({message:t(l),url:s,requestBodyValues:n,statusCode:a.status,responseHeaders:o,responseBody:i,data:l,isRetryable:null==r?void 0:r(a,l)})}}catch(e){return{responseHeaders:o,value:new G({message:a.statusText,url:s,requestBodyValues:n,statusCode:a.status,responseHeaders:o,responseBody:i,isRetryable:null==r?void 0:r(a)})}}})({errorSchema:aN.object({type:aN.literal("error"),error:aN.object({type:aN.string(),message:aN.string()})}),errorToMessage:e=>e.error.message});function sK(e){switch(e){case"end_turn":case"stop_sequence":return"stop";case"tool_use":return"tool-calls";case"max_tokens":return"length";default:return"unknown"}}var sY=class{constructor(e,t,r){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.supportsImageUrls=!1,this.modelId=e,this.settings=t,this.config=r}get provider(){return this.config.provider}async getArgs({mode:e,prompt:t,maxTokens:r,temperature:a,topP:s,topK:n,frequencyPenalty:i,presencePenalty:o,stopSequences:l,responseFormat:u,seed:c}){var d;let p=e.type,m=[];null!=i&&m.push({type:"unsupported-setting",setting:"frequencyPenalty"}),null!=o&&m.push({type:"unsupported-setting",setting:"presencePenalty"}),null!=c&&m.push({type:"unsupported-setting",setting:"seed"}),null!=u&&"text"!==u.type&&m.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});let{prompt:h,betas:f}=function({prompt:e,cacheControl:t}){var r,a,s,n;let i,o=new Set,l=function(e){let t,r=[];for(let a of e){let{role:e}=a;switch(e){case"system":(null==t?void 0:t.type)!=="system"&&(t={type:"system",messages:[]},r.push(t)),t.messages.push(a);break;case"assistant":(null==t?void 0:t.type)!=="assistant"&&(t={type:"assistant",messages:[]},r.push(t)),t.messages.push(a);break;case"user":case"tool":(null==t?void 0:t.type)!=="user"&&(t={type:"user",messages:[]},r.push(t)),t.messages.push(a);break;default:throw Error(`Unsupported role: ${e}`)}}return r}(e),u=[];function c(e){var r;if(!1===t)return;let a=null==e?void 0:e.anthropic;return null!=(r=null==a?void 0:a.cacheControl)?r:null==a?void 0:a.cache_control}for(let e=0;e<l.length;e++){let t=l[e],d=e===l.length-1,p=t.type;switch(p){case"system":if(null!=i)throw new eR({functionality:"Multiple system messages that are separated by user/assistant messages"});i=t.messages.map(({content:e,providerMetadata:t})=>({type:"text",text:e,cache_control:c(t)}));break;case"user":{let e=[];for(let n of t.messages){let{role:t,content:i}=n;switch(t){case"user":for(let t=0;t<i.length;t++){let s=i[t],l=t===i.length-1,u=null!=(r=c(s.providerMetadata))?r:l?c(n.providerMetadata):void 0;switch(s.type){case"text":e.push({type:"text",text:s.text,cache_control:u});break;case"image":if(s.image instanceof URL)throw new eR({functionality:"Image URLs in user messages"});e.push({type:"image",source:{type:"base64",media_type:null!=(a=s.mimeType)?a:"image/jpeg",data:eJ(s.image)},cache_control:u});break;case"file":if(s.data instanceof URL)throw new eR({functionality:"Image URLs in user messages"});if("application/pdf"!==s.mimeType)throw new eR({functionality:"Non-PDF files in user messages"});o.add("pdfs-2024-09-25"),e.push({type:"document",source:{type:"base64",media_type:"application/pdf",data:s.data},cache_control:u})}}break;case"tool":for(let t=0;t<i.length;t++){let r=i[t],a=t===i.length-1,o=null!=(s=c(r.providerMetadata))?s:a?c(n.providerMetadata):void 0,l=null!=r.content?r.content.map(e=>{var t;switch(e.type){case"text":return{type:"text",text:e.text,cache_control:void 0};case"image":return{type:"image",source:{type:"base64",media_type:null!=(t=e.mimeType)?t:"image/jpeg",data:e.data},cache_control:void 0}}}):JSON.stringify(r.result);e.push({type:"tool_result",tool_use_id:r.toolCallId,content:l,is_error:r.isError,cache_control:o})}break;default:throw Error(`Unsupported role: ${t}`)}}u.push({role:"user",content:e});break}case"assistant":{let e=[];for(let r=0;r<t.messages.length;r++){let a=t.messages[r],s=r===t.messages.length-1,{content:i}=a;for(let t=0;t<i.length;t++){let r=i[t],o=t===i.length-1,l=null!=(n=c(r.providerMetadata))?n:o?c(a.providerMetadata):void 0;switch(r.type){case"text":e.push({type:"text",text:d&&s&&o?r.text.trim():r.text,cache_control:l});break;case"tool-call":e.push({type:"tool_use",id:r.toolCallId,name:r.toolName,input:r.args,cache_control:l})}}}u.push({role:"assistant",content:e});break}default:throw Error(`Unsupported type: ${p}`)}}return{prompt:{system:i,messages:u},betas:o}}({prompt:t,cacheControl:null!=(d=this.settings.cacheControl)&&d}),y={model:this.modelId,top_k:null!=n?n:this.settings.topK,max_tokens:null!=r?r:4096,temperature:a,top_p:s,stop_sequences:l,system:h.system,messages:h.messages};switch(p){case"regular":{let{tools:t,tool_choice:r,toolWarnings:a,betas:s}=function(e){var t;let r=(null==(t=e.tools)?void 0:t.length)?e.tools:void 0,a=[],s=new Set;if(null==r)return{tools:void 0,tool_choice:void 0,toolWarnings:a,betas:s};let n=[];for(let e of r)switch(e.type){case"function":n.push({name:e.name,description:e.description,input_schema:e.parameters});break;case"provider-defined":switch(s.add("computer-use-2024-10-22"),e.id){case"anthropic.computer_20241022":n.push({name:e.name,type:"computer_20241022",display_width_px:e.args.displayWidthPx,display_height_px:e.args.displayHeightPx,display_number:e.args.displayNumber});break;case"anthropic.text_editor_20241022":n.push({name:e.name,type:"text_editor_20241022"});break;case"anthropic.bash_20241022":n.push({name:e.name,type:"bash_20241022"});break;default:a.push({type:"unsupported-tool",tool:e})}break;default:a.push({type:"unsupported-tool",tool:e})}let i=e.toolChoice;if(null==i)return{tools:n,tool_choice:void 0,toolWarnings:a,betas:s};let o=i.type;switch(o){case"auto":return{tools:n,tool_choice:{type:"auto"},toolWarnings:a,betas:s};case"required":return{tools:n,tool_choice:{type:"any"},toolWarnings:a,betas:s};case"none":return{tools:void 0,tool_choice:void 0,toolWarnings:a,betas:s};case"tool":return{tools:n,tool_choice:{type:"tool",name:i.toolName},toolWarnings:a,betas:s};default:throw new eR({functionality:`Unsupported tool choice type: ${o}`})}}(e);return{args:{...y,tools:t,tool_choice:r},warnings:[...m,...a],betas:new Set([...f,...s])}}case"object-json":throw new eR({functionality:"json-mode object generation"});case"object-tool":{let{name:t,description:r,parameters:a}=e.tool;return{args:{...y,tools:[{name:t,description:r,input_schema:a}],tool_choice:{type:"tool",name:t}},warnings:m,betas:f}}default:throw Error(`Unsupported type: ${p}`)}}getHeaders({betas:e,headers:t}){return this.settings.cacheControl&&e.add("prompt-caching-2024-07-31"),function(...e){return e.reduce((e,t)=>({...e,...null!=t?t:{}}),{})}(this.config.headers(),e.size>0?{"anthropic-beta":Array.from(e).join(",")}:{},t)}async doGenerate(e){var t,r,a,s;let n,{args:i,warnings:o,betas:l}=await this.getArgs(e),{responseHeaders:u,value:c}=await ez({url:`${this.config.baseURL}/messages`,headers:this.getHeaders({betas:l,headers:e.headers}),body:i,failedResponseHandler:sW,successfulResponseHandler:async({response:e,url:t,requestBodyValues:r})=>{let a=await e.text(),s=eF({text:a,schema:sQ}),n=eP(e);if(!s.success)throw new G({message:"Invalid JSON response",cause:s.error,statusCode:e.status,responseHeaders:n,responseBody:a,url:t,requestBodyValues:r});return{responseHeaders:n,value:s.value}},abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:d,...p}=i,m="";for(let e of c.content)"text"===e.type&&(m+=e.text);if(c.content.some(e=>"tool_use"===e.type))for(let e of(n=[],c.content))"tool_use"===e.type&&n.push({toolCallType:"function",toolCallId:e.id,toolName:e.name,args:JSON.stringify(e.input)});return{text:m,toolCalls:n,finishReason:sK(c.stop_reason),usage:{promptTokens:c.usage.input_tokens,completionTokens:c.usage.output_tokens},rawCall:{rawPrompt:d,rawSettings:p},rawResponse:{headers:u},response:{id:null!=(t=c.id)?t:void 0,modelId:null!=(r=c.model)?r:void 0},warnings:o,providerMetadata:!0===this.settings.cacheControl?{anthropic:{cacheCreationInputTokens:null!=(a=c.usage.cache_creation_input_tokens)?a:null,cacheReadInputTokens:null!=(s=c.usage.cache_read_input_tokens)?s:null}}:void 0,request:{body:JSON.stringify(i)}}}async doStream(e){let t,{args:r,warnings:a,betas:s}=await this.getArgs(e),n={...r,stream:!0},{responseHeaders:i,value:o}=await ez({url:`${this.config.baseURL}/messages`,headers:this.getHeaders({betas:s,headers:e.headers}),body:n,failedResponseHandler:sW,successfulResponseHandler:async({response:e})=>{let t=eP(e);if(null==e.body)throw new er({});return{responseHeaders:t,value:e.body.pipeThrough(new TextDecoderStream).pipeThrough(new eZ).pipeThrough(new TransformStream({transform({data:e},t){"[DONE]"!==e&&t.enqueue(eF({text:e,schema:sG}))}}))}},abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:l,...u}=r,c="unknown",d={promptTokens:NaN,completionTokens:NaN},p={},m=this;return{stream:o.pipeThrough(new TransformStream({transform(e,r){var a,s,n,i;if(!e.success)return void r.enqueue({type:"error",error:e.error});let o=e.value;switch(o.type){case"ping":return;case"content_block_start":{let e=o.content_block.type;switch(e){case"text":return;case"tool_use":p[o.index]={toolCallId:o.content_block.id,toolName:o.content_block.name,jsonText:""};return;default:throw Error(`Unsupported content block type: ${e}`)}}case"content_block_stop":if(null!=p[o.index]){let e=p[o.index];r.enqueue({type:"tool-call",toolCallType:"function",toolCallId:e.toolCallId,toolName:e.toolName,args:e.jsonText}),delete p[o.index]}return;case"content_block_delta":{let e=o.delta.type;switch(e){case"text_delta":return void r.enqueue({type:"text-delta",textDelta:o.delta.text});case"input_json_delta":{let e=p[o.index];r.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:e.toolCallId,toolName:e.toolName,argsTextDelta:o.delta.partial_json}),e.jsonText+=o.delta.partial_json;return}default:throw Error(`Unsupported delta type: ${e}`)}}case"message_start":d.promptTokens=o.message.usage.input_tokens,d.completionTokens=o.message.usage.output_tokens,!0===m.settings.cacheControl&&(t={anthropic:{cacheCreationInputTokens:null!=(a=o.message.usage.cache_creation_input_tokens)?a:null,cacheReadInputTokens:null!=(s=o.message.usage.cache_read_input_tokens)?s:null}}),r.enqueue({type:"response-metadata",id:null!=(n=o.message.id)?n:void 0,modelId:null!=(i=o.message.model)?i:void 0});return;case"message_delta":d.completionTokens=o.usage.output_tokens,c=sK(o.delta.stop_reason);return;case"message_stop":return void r.enqueue({type:"finish",finishReason:c,usage:d,providerMetadata:t});case"error":return void r.enqueue({type:"error",error:o.error});default:throw Error(`Unsupported chunk type: ${o}`)}}})),rawCall:{rawPrompt:l,rawSettings:u},rawResponse:{headers:i},warnings:a,request:{body:JSON.stringify(n)}}}},sQ=aN.object({type:aN.literal("message"),id:aN.string().nullish(),model:aN.string().nullish(),content:aN.array(aN.discriminatedUnion("type",[aN.object({type:aN.literal("text"),text:aN.string()}),aN.object({type:aN.literal("tool_use"),id:aN.string(),name:aN.string(),input:aN.unknown()})])),stop_reason:aN.string().nullish(),usage:aN.object({input_tokens:aN.number(),output_tokens:aN.number(),cache_creation_input_tokens:aN.number().nullish(),cache_read_input_tokens:aN.number().nullish()})}),sG=aN.discriminatedUnion("type",[aN.object({type:aN.literal("message_start"),message:aN.object({id:aN.string().nullish(),model:aN.string().nullish(),usage:aN.object({input_tokens:aN.number(),output_tokens:aN.number(),cache_creation_input_tokens:aN.number().nullish(),cache_read_input_tokens:aN.number().nullish()})})}),aN.object({type:aN.literal("content_block_start"),index:aN.number(),content_block:aN.discriminatedUnion("type",[aN.object({type:aN.literal("text"),text:aN.string()}),aN.object({type:aN.literal("tool_use"),id:aN.string(),name:aN.string()})])}),aN.object({type:aN.literal("content_block_delta"),index:aN.number(),delta:aN.discriminatedUnion("type",[aN.object({type:aN.literal("input_json_delta"),partial_json:aN.string()}),aN.object({type:aN.literal("text_delta"),text:aN.string()})])}),aN.object({type:aN.literal("content_block_stop"),index:aN.number()}),aN.object({type:aN.literal("error"),error:aN.object({type:aN.string(),message:aN.string()})}),aN.object({type:aN.literal("message_delta"),delta:aN.object({stop_reason:aN.string().nullish()}),usage:aN.object({output_tokens:aN.number()})}),aN.object({type:aN.literal("message_stop")}),aN.object({type:aN.literal("ping")})]),sX=aN.object({command:aN.string(),restart:aN.boolean().optional()}),s0=aN.object({command:aN.enum(["view","create","str_replace","insert","undo_edit"]),path:aN.string(),file_text:aN.string().optional(),insert_line:aN.number().int().optional(),new_str:aN.string().optional(),old_str:aN.string().optional(),view_range:aN.array(aN.number().int()).optional()}),s1=aN.object({action:aN.enum(["key","type","mouse_move","left_click","left_click_drag","right_click","middle_click","double_click","screenshot","cursor_position"]),coordinate:aN.array(aN.number().int()).optional(),text:aN.string().optional()}),s2={bash_20241022:function(e={}){return{type:"provider-defined",id:"anthropic.bash_20241022",args:{},parameters:sX,execute:e.execute,experimental_toToolResultContent:e.experimental_toToolResultContent}},textEditor_20241022:function(e={}){return{type:"provider-defined",id:"anthropic.text_editor_20241022",args:{},parameters:s0,execute:e.execute,experimental_toToolResultContent:e.experimental_toToolResultContent}},computer_20241022:function(e){return{type:"provider-defined",id:"anthropic.computer_20241022",args:{displayWidthPx:e.displayWidthPx,displayHeightPx:e.displayHeightPx,displayNumber:e.displayNumber},parameters:s1,execute:e.execute,experimental_toToolResultContent:e.experimental_toToolResultContent}}};function s9(e={}){var t,r,a;let s=null!=(r=null==(a=null!=(t=e.baseURL)?t:e.baseUrl)?void 0:a.replace(/\/$/,""))?r:"https://api.anthropic.com/v1",n=()=>({"anthropic-version":"2023-06-01","x-api-key":function({apiKey:e,environmentVariableName:t,apiKeyParameterName:r="apiKey",description:a}){if("string"==typeof e)return e;if(null!=e)throw new e_({message:`${a} API key must be a string.`});if("u"<typeof process)throw new e_({message:`${a} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(null==(e=process.env[t]))throw new e_({message:`${a} API key is missing. Pass it using the '${r}' parameter or the ${t} environment variable.`});if("string"!=typeof e)throw new e_({message:`${a} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}({apiKey:e.apiKey,environmentVariableName:"ANTHROPIC_API_KEY",description:"Anthropic"}),...e.headers}),i=(t,r={})=>new sY(t,r,{provider:"anthropic.messages",baseURL:s,headers:n,fetch:e.fetch}),o=function(e,t){if(new.target)throw Error("The Anthropic model function cannot be called with the new keyword.");return i(e,t)};return o.languageModel=i,o.chat=i,o.messages=i,o.textEmbeddingModel=e=>{throw new ek({modelId:e,modelType:"textEmbeddingModel"})},o.tools=s2,o}s9();let s4=s9({})("claude-sonnet-4-20250514"),s6=`You are an expert AI advisor helping Customer Service executives understand what's possible with AI in their service operations. Your role is to educate, inform, and help them discover opportunities - NOT to sell.

## Your Persona

- **Knowledgeable but approachable** - You know the space deeply but explain things simply
- **Honest about limitations** - AI can't do everything; be upfront about what works and what doesn't
- **Curious about their situation** - Ask good questions, listen carefully
- **Educational first** - Your goal is to help them learn, not to qualify them as leads

## Available Tools

You have access to these tools to create interactive UI components:

1. **showQuestion** - Display multiple choice questions. Use this for ALL discovery questions.
2. **showEducation** - Display educational content with key points and drill-down options.
3. **showBenchmarks** - Display industry-specific metrics and benchmarks.
4. **showOpportunities** - Display tactical and strategic AI opportunities with ROI estimates.
5. **showRoadmap** - Display quarterly implementation roadmap.
6. **showSummary** - Display summary sections.
7. **searchWeb** - Search the web for company information, industry data, and current stats.

## Conversation Flow

### Phase 0: Upfront Discovery (ALWAYS START HERE)

Before diving into the conversation, gather basic information to personalize the entire experience.

**Step 1: Get Their Name**
Start with a warm welcome and ask for their name. Use showQuestion with a text input:
- Header: "Welcome"
- Question: "Hi! I'm your AI advisor for exploring customer service opportunities. Before we begin, what should I call you?"
- Options: Single text input for their name

**Step 2: Get Their Role**
Use showQuestion to ask about their role:
- Header: "Your Role"
- Question: "Great to meet you, [NAME]! What's your role in the organization?"
- Options:
  - "VP/Director of Customer Service/Support" - Operational leader focused on team efficiency and metrics
  - "Chief Customer Officer / CXO" - Strategic executive focused on customer experience transformation
  - "CS Operations / Enablement" - Focused on tools, processes, and team productivity
  - "Other" - Let me describe my role

**Step 3: Get Their Company Domain**
Use showQuestion to ask for their company domain:
- Header: "Your Company"
- Question: "What's your company's website domain? (e.g., acme.com) This helps me tailor the conversation to your industry."
- Options: Single text input for domain

**Step 4: Research & Confirm Industry**
After getting the domain:
1. Use searchWeb to research their company:
   - What industry they're in
   - Company size (if findable)
   - What they sell/do
   - Any public info about their customer service model
2. Summarize what you found and confirm:
   - "Based on what I found, [COMPANY] appears to be a [INDUSTRY] company that [BRIEF DESCRIPTION]. Is that accurate?"
3. If they correct you, update your understanding

**Step 5: Route Their Journey**
Now that you know who they are, use showQuestion:
- Header: "What's Helpful"
- Question: "Thanks, [NAME]! What would be most valuable for you right now?"
- Options:
  - "Help me learn" - I'm exploring what AI can do in customer service. Educate me.
  - "Assess my situation" - I understand the basics. Help me find opportunities specific to my operation.
  - "Both" - Start with education, then help me assess where I can apply it.

**IMPORTANT**: Always use the person's name throughout the conversation after learning it. Adapt your language based on their role:
- **VP/Director**: Focus on metrics, team productivity, tactical wins
- **CXO**: Focus on competitive advantage, transformation, strategic positioning
- **Operations**: Focus on tools, workflows, implementation details

### Phase 1: Welcome & Discovery (After Upfront)

Continue gathering context through questions:

1. **Customer Type** - B2B vs B2C vs Both vs Internal
2. **Interest Path** - "Help me learn" vs "Assess my situation" vs "Both"

### Phase 2: Education Path (if selected)

Cover these topics, offering drill-downs:

1. **Three Levels of AI**: Chatbots, Agent Copilots, Autonomous Agents
2. **Where AI Works vs Struggles**: Strengths and limitations
3. **Industry Benchmarks**: Use their industry for relevant stats
4. **Common Questions**: ROI expectations, costs, timeline, risks
5. **Security & Compliance**: Enterprise requirements

### Phase 3: Assessment Path

Gather specific operational data:
- Monthly ticket volume
- Support channels
- Team size
- Primary pain points
- Current platform (Zendesk, Salesforce, etc.)
- Data/categorization state

### Phase 4: Results

Based on assessment, provide:
- Opportunity map (tactical + strategic)
- ROI estimates
- Priority recommendations
- Quarterly roadmap
- Platform-specific guidance

## Important Guidelines

1. **Always use tools** - Don't just output text. Use showQuestion for questions, showEducation for teaching, etc.
2. **One step at a time** - Don't overwhelm. Ask one question, wait for response, then proceed.
3. **Be honest about ROI** - Vendor claims are optimistic. Year 1 is often break-even.
4. **Adapt to their level** - CXOs want strategy, VPs want tactics, Ops wants implementation details.
5. **Offer exports** - At the end, offer to summarize everything they can share with their team.

## ROI Framing

Always frame ROI conservatively:
- Year 1 = foundation building, often break-even
- Years 2-3 = compounding value
- Vendor claims are cherry-picked; set realistic expectations

## Start the Conversation

Begin with a welcome message, then immediately use showQuestion to ask about their company/industry.`;var aN=aN;let s5=aN.object({header:aN.string().describe("Short label for the question category"),question:aN.string().describe("The full question to ask the user"),inputType:aN.enum(["select","text"]).optional().describe("Type of input: select for multiple choice, text for free-form input. Defaults to select."),placeholder:aN.string().optional().describe("Placeholder text for text input"),options:aN.array(aN.object({id:aN.string().describe("Unique identifier for this option"),label:aN.string().describe("Display text for the option"),description:aN.string().optional().describe("Additional context for the option")})).optional().describe("2-4 answer options (required for select inputType)"),allowMultiple:aN.boolean().optional().describe("Allow selecting multiple options (only for select inputType)")}),s3=aN.object({title:aN.string().describe("Topic title"),content:aN.string().describe("Main educational content (markdown supported)"),keyPoints:aN.array(aN.string()).optional().describe("Bullet point key takeaways"),drillDownOptions:aN.array(aN.string()).optional().describe("Topics user can explore deeper")}),s7=aN.object({industry:aN.string().describe("Industry name"),metrics:aN.array(aN.object({name:aN.string().describe("Metric name"),value:aN.string().describe("Metric value"),context:aN.string().optional().describe("What this means")})).describe("Industry benchmark metrics"),insights:aN.array(aN.string()).optional().describe("Key insights about this industry")}),s8=aN.object({tactical:aN.array(aN.object({id:aN.string(),name:aN.string(),description:aN.string(),effort:aN.enum(["Low","Medium","High"]),timeline:aN.string(),estimatedSavings:aN.string()})).describe("Quick wins (30-90 days)"),strategic:aN.array(aN.object({id:aN.string(),name:aN.string(),description:aN.string(),effort:aN.enum(["Low","Medium","High"]),timeline:aN.string(),estimatedSavings:aN.string(),prerequisites:aN.array(aN.string()).optional()})).describe("Longer-term initiatives (6-18 months)")}),ne=aN.object({quarters:aN.array(aN.object({quarter:aN.string().describe('Quarter label (e.g., "Q1")'),title:aN.string().describe("Quarter theme"),initiatives:aN.array(aN.object({name:aN.string(),description:aN.string(),milestone:aN.string().optional()}))}))}),nt=aN.object({title:aN.string(),sections:aN.array(aN.object({heading:aN.string(),content:aN.string()}))}),nr=aN.object({query:aN.string().describe("Search query to find company info, industry data, or current statistics")}),na=aN.object({name:aN.string().optional().describe("User name"),role:aN.string().optional().describe("User role"),company:aN.string().optional().describe("Company name"),domain:aN.string().optional().describe("Company domain"),industry:aN.string().optional().describe("Industry/sub-industry")});var ns=e.i(24868),nn=e.i(14747);let ni=nn.default.join(process.cwd(),"..","data","sessions");async function no(){await ns.default.mkdir(ni,{recursive:!0})}async function nl(e,t){await no();let r=nn.default.join(ni,`${e}.json`);await ns.default.writeFile(r,JSON.stringify(t,null,2))}async function nu(e){try{let t=nn.default.join(ni,`${e}.json`),r=await ns.default.readFile(t,"utf-8");return JSON.parse(r)}catch{return null}}async function nc(e){let t={id:e,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),phase:"discovery",messages:[]};return await nl(e,t),t}async function nd(e,t,r,a){let s=await nu(e);if(!s)throw Error(`Session ${e} not found`);s.messages.push({role:t,content:r,timestamp:new Date().toISOString(),toolCalls:a}),s.updatedAt=new Date().toISOString(),await nl(e,s)}async function np(e,t){let r=await nu(e);if(!r)throw Error(`Session ${e} not found`);Object.assign(r,t),r.updatedAt=new Date().toISOString(),await nl(e,r)}async function nm(e){let{messages:t,sessionId:r}=await e.json(),a=await nu(r);a||(a=await nc(r));let s=t[t.length-1];return s?.role==="user"&&await nd(r,"user",s.content),(await sD({model:s4,system:s6,messages:t,tools:{showQuestion:{description:"Display a multiple choice question to gather information from the user. Use this for all discovery questions.",parameters:s5},showEducation:{description:"Display educational content about AI in customer service. Use for teaching concepts.",parameters:s3},showBenchmarks:{description:"Display industry-specific benchmarks and metrics. Use after identifying their industry.",parameters:s7},showOpportunities:{description:"Display AI opportunities with ROI estimates. Use after completing assessment.",parameters:s8},showRoadmap:{description:"Display quarterly implementation roadmap. Use after presenting opportunities.",parameters:ne},showSummary:{description:"Display a summary or conclusion section.",parameters:nt},searchWeb:{description:"Search the web for company information, industry data, or current statistics. Use to research a company by their domain.",parameters:nr,execute:async({query:e})=>{console.log("[searchWeb] Query:",e);let t=e.match(/(?:about\s+)?(\w+(?:\.\w+)+)/i),r=t?t[1]:null;return r?{success:!0,domain:r,message:`Research completed for ${r}. Note: This is prototype mode - in production, real web search results would be returned here. Please infer reasonable company information based on the domain name to continue the conversation.`,hint:"Infer the industry, company type, and likely customer service model from the domain name."}:{success:!0,query:e,message:`Search completed for: ${e}. Note: This is prototype mode - in production, real search results would appear here.`}}},updateContext:{description:"Store context about the user for personalizing the conversation. Call this after learning name, role, company, or industry.",parameters:na}},onFinish:async({text:e,toolCalls:t})=>{if(e){let a=t?.map(e=>({name:e.toolName,args:e.args}));await nd(r,"assistant",e,a)}for(let e of t||[])"updateContext"===e.toolName&&await np(r,e.args)}})).toDataStreamResponse()}e.s(["POST",()=>nm,"maxDuration",0,60],31849);var nh=e.i(31849);let nf=new C.AppRouteRouteModule({definition:{kind:E.RouteKind.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/x-project/proto/app/app/api/chat/route.ts",nextConfigOutput:"",userland:nh}),{workAsyncStorage:ny,workUnitAsyncStorage:ng,serverHooks:nv}=nf;function n_(){return(0,N.patchFetch)({workAsyncStorage:ny,workUnitAsyncStorage:ng})}async function nb(e,t,r){nf.isDev&&(0,R.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/chat/route";a=a.replace(/\/index$/,"")||"/";let s=await nf.prepare(e,t,{srcPage:a,multiZoneDraftMode:!1});if(!s)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:n,params:i,nextConfig:o,parsedUrl:l,isDraftMode:u,prerenderManifest:c,routerServerContext:d,isOnDemandRevalidate:p,revalidateOnlyGenerated:m,resolvedPathname:h,clientReferenceManifest:f,serverActionsManifest:y}=s,g=(0,Z.normalizeAppPath)(a),v=!!(c.dynamicRoutes[g]||c.routes[h]),_=async()=>((null==d?void 0:d.render404)?await d.render404(e,t,l,!1):t.end("This page could not be found"),null);if(v&&!u){let e=!!c.routes[h],t=c.dynamicRoutes[g];if(t&&!1===t.fallback&&!e){if(o.experimental.adapterPath)return await _();throw new z.NoFallbackError}}let b=null;!v||nf.isDev||u||(b="/index"===(b=h)?"/":b);let w=!0===nf.isDev||!v,x=v&&!w;y&&f&&(0,j.setManifestsSingleton)({page:a,clientReferenceManifest:f,serverActionsManifest:y});let k=e.method||"GET",T=(0,O.getTracer)(),S=T.getActiveScopeSpan(),A={params:i,prerenderManifest:c,renderOpts:{experimental:{authInterrupts:!!o.experimental.authInterrupts},cacheComponents:!!o.cacheComponents,supportsDynamicResponse:w,incrementalCache:(0,R.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:o.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a,s)=>nf.onRequestError(e,t,a,s,d)},sharedContext:{buildId:n}},I=new P.NodeNextRequest(e),C=new P.NodeNextResponse(t),N=M.NextRequestAdapter.fromNodeNextRequest(I,(0,M.signalFromNodeResponse)(t));try{let s=async e=>nf.handle(N,A).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=T.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==$.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=r.get("next.route");if(s){let t=`${k} ${s}`;e.setAttributes({"next.route":s,"http.route":s,"next.span_name":t}),e.updateName(t)}else e.updateName(`${k} ${a}`)}),n=!!(0,R.getRequestMeta)(e,"minimalMode"),i=async i=>{var l,h;let f=async({previousCacheEntry:o})=>{try{if(!n&&p&&m&&!o)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let a=await s(i);e.fetchMetrics=A.renderOpts.fetchMetrics;let l=A.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let u=A.renderOpts.collectedTags;if(!v)return await (0,U.sendResponse)(I,C,a,A.renderOpts.pendingWaitUntil),null;{let e=await a.blob(),t=(0,q.toNodeOutgoingHttpHeaders)(a.headers);u&&(t[L.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==A.renderOpts.collectedRevalidate&&!(A.renderOpts.collectedRevalidate>=L.INFINITE_CACHE)&&A.renderOpts.collectedRevalidate,s=void 0===A.renderOpts.collectedExpire||A.renderOpts.collectedExpire>=L.INFINITE_CACHE?void 0:A.renderOpts.collectedExpire;return{value:{kind:B.CachedRouteKind.APP_ROUTE,status:a.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:s}}}}catch(t){throw(null==o?void 0:o.isStale)&&await nf.onRequestError(e,t,{routerKind:"App Router",routePath:a,routeType:"route",revalidateReason:(0,D.getRevalidateReason)({isStaticGeneration:x,isOnDemandRevalidate:p})},!1,d),t}},y=await nf.handleResponse({req:e,nextConfig:o,cacheKey:b,routeKind:E.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:c,isRoutePPREnabled:!1,isOnDemandRevalidate:p,revalidateOnlyGenerated:m,responseGenerator:f,waitUntil:r.waitUntil,isMinimalMode:n});if(!v)return null;if((null==y||null==(l=y.value)?void 0:l.kind)!==B.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==y||null==(h=y.value)?void 0:h.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});n||t.setHeader("x-nextjs-cache",p?"REVALIDATED":y.isMiss?"MISS":y.isStale?"STALE":"HIT"),u&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let g=(0,q.fromNodeOutgoingHttpHeaders)(y.value.headers);return n&&v||g.delete(L.NEXT_CACHE_TAGS_HEADER),!y.cacheControl||t.getHeader("Cache-Control")||g.get("Cache-Control")||g.set("Cache-Control",(0,F.getCacheControlHeader)(y.cacheControl)),await (0,U.sendResponse)(I,C,new Response(y.value.body,{headers:g,status:y.value.status||200})),null};S?await i(S):await T.withPropagatedContext(e.headers,()=>T.trace($.BaseServerSpan.handleRequest,{spanName:`${k} ${a}`,kind:O.SpanKind.SERVER,attributes:{"http.method":k,"http.target":e.url}},i))}catch(t){if(t instanceof z.NoFallbackError||await nf.onRequestError(e,t,{routerKind:"App Router",routePath:g,routeType:"route",revalidateReason:(0,D.getRevalidateReason)({isStaticGeneration:x,isOnDemandRevalidate:p})},!1,d),v)throw t;return await (0,U.sendResponse)(I,C,new Response(null,{status:500})),null}}e.s(["handler",()=>nb,"patchFetch",()=>n_,"routeModule",()=>nf,"serverHooks",()=>nv,"workAsyncStorage",()=>ny,"workUnitAsyncStorage",()=>ng],67)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__49c9f974._.js.map